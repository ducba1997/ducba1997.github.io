"use strict";(self["webpackChunkvue_firebase_crud_app"]=self["webpackChunkvue_firebase_crud_app"]||[]).push([[306],{3306:function(t,n,a){a.r(n),a.d(n,{default:function(){return N}});var e=function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"row"},[a("div",[a("b-button",{staticClass:"float-right",attrs:{variant:"success"},on:{click:function(n){t.show_popup_them_moi=!0}}},[t._v("Thêm mới hóa đơn")]),a("b-modal",{attrs:{title:"Thêm mới hóa đơn",size:"lg"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("b-button",{staticClass:"float-right",attrs:{variant:"primary",size:"sm"},on:{click:function(n){t.show_popup_them_moi=!1}}},[t._v(" Đóng ")])],1)]},proxy:!0}]),model:{value:t.show_popup_them_moi,callback:function(n){t.show_popup_them_moi=n},expression:"show_popup_them_moi"}},[a("themmoi")],1),a("b-modal",{attrs:{title:"Cập nhật hóa đơn",size:"lg"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("b-button",{staticClass:"float-right",attrs:{variant:"primary",size:"sm"},on:{click:function(n){t.show_popup_sua=!1}}},[t._v(" Đóng ")])],1)]},proxy:!0}]),model:{value:t.show_popup_sua,callback:function(n){t.show_popup_sua=n},expression:"show_popup_sua"}},[a("sua",{attrs:{hoadon_item:t.hoadon_item_selected}})],1)],1),a("div",{staticClass:"col-md-12"},[a("p",{staticClass:"h5 font-weight-bold text-center"},[t._v("Danh sách hóa đơn")]),a("b-form-group",{staticClass:"my-2",attrs:{label:"Tìm kiếm","label-for":"filter-input"}},[a("b-input-group",{attrs:{size:"sm"}},[a("b-form-input",{attrs:{id:"filter-input",type:"search",placeholder:"Nhập từ khóa để tìm kiếm"},model:{value:t.filter,callback:function(n){t.filter=n},expression:"filter"}}),a("b-input-group-append",[a("b-button",{attrs:{disabled:!t.filter},on:{click:function(n){t.filter=""}}},[t._v("Xóa")])],1)],1)],1),a("b-table",{staticClass:"table-hoadon",attrs:{striped:"",hover:"",items:t.danh_sach_hoa_don,fields:t.fields_table,filter:t.filter,"per-page":t.perPage,"current-page":t.currentPage,id:"my-table"},scopedSlots:t._u([{key:"cell(stt)",fn:function(n){return[t._v(" "+t._s(n.item.stt)+" ")]}},{key:"cell(nocu)",fn:function(n){return[t._v(" "+t._s(t.formatMoney(n.item.nocu,0,2))+" VNĐ ")]}},{key:"cell(dathanhtoan)",fn:function(n){return[t._v(" "+t._s(t.formatMoney(n.item.dathanhtoan,0,2))+" VNĐ ")]}},{key:"cell(tongtien)",fn:function(n){return[t._v(" "+t._s(t.formatMoney(t.sum_arr(n.item.cthd.map((function(t){return parseFloat(t.thanhtien)}))),0,2))+" VNĐ ")]}},{key:"cell(key)",fn:function(n){return[a("button",{staticClass:"btn btn-primary",on:{click:function(a){return a.preventDefault(),t.$router.push("/chi-tiet-hoa-don/"+n.item.mahd)}}},[t._v(" Chi tiết ")]),a("button",{staticClass:"btn btn-info",on:{click:function(a){a.preventDefault(),t.hoadon_item_selected=JSON.parse(JSON.stringify(n.item)),t.show_popup_sua=!0}}},[t._v(" Sửa ")]),a("button",{staticClass:"btn btn-danger ml-2",on:{click:function(a){return a.preventDefault(),t.deleteHoadon(n.item.key)}}},[t._v(" Xóa ")])]}}])}),a("b-pagination",{attrs:{"total-rows":t.danh_sach_hoa_don.length,"per-page":t.perPage,"aria-controls":"my-table"},model:{value:t.currentPage,callback:function(n){t.currentPage=n},expression:"currentPage"}})],1)])},o=[];a(2526),a(1817),a(1539),a(2165),a(8783),a(3948),a(1703),a(7042),a(8309),a(1038),a(4916),a(7601);function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var a=0,e=new Array(n);a<n;a++)e[a]=t[a];return e}function i(t,n){if(t){if("string"===typeof t)return r(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(t,n):void 0}}function s(t,n){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=i(t))||n&&t&&"number"===typeof t.length){a&&(t=a);var e=0,o=function(){};return{s:o,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){l=!0,r=t},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(l)throw r}}}}a(4747);var l=a(4805),c=function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"row justify-content-center"},[a("div",{},[a("h3",{staticClass:"text-center"},[t._v("Thêm mới hóa đơn")]),a("form",{on:{submit:function(n){return n.preventDefault(),t.themmoi.apply(null,arguments)}}},[a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Tên khách hàng")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.tenkh,expression:"hoadon.tenkh"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.tenkh},on:{input:function(n){n.target.composing||t.$set(t.hoadon,"tenkh",n.target.value)}}})]),a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Số điện thoại")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.sdt,expression:"hoadon.sdt"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.sdt},on:{input:function(n){n.target.composing||t.$set(t.hoadon,"sdt",n.target.value)}}})]),a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Địa chỉ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.diachi,expression:"hoadon.diachi"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.diachi},on:{input:function(n){n.target.composing||t.$set(t.hoadon,"diachi",n.target.value)}}})]),a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Ngày")]),a("b-form-datepicker",{attrs:{"date-format-options":{year:"numeric",month:"numeric",day:"numeric"},locale:"en"},model:{value:t.hoadon.ngaylap,callback:function(n){t.$set(t.hoadon,"ngaylap",n)},expression:"hoadon.ngaylap"}})],1),a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Đã thanh toán")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.dathanhtoan,expression:"hoadon.dathanhtoan"}],staticClass:"form-control",attrs:{type:"number",required:""},domProps:{value:t.hoadon.dathanhtoan},on:{input:function(n){n.target.composing||t.$set(t.hoadon,"dathanhtoan",n.target.value)}}})]),a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Nợ cũ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.nocu,expression:"hoadon.nocu"}],staticClass:"form-control",attrs:{type:"number",required:""},domProps:{value:t.hoadon.nocu},on:{input:function(n){n.target.composing||t.$set(t.hoadon,"nocu",n.target.value)}}})]),t._m(0)])])])},u=[function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"form-group mt-2 mt-2"},[a("button",{staticClass:"btn btn-success btn-block"},[t._v("Thêm mới")])])}],d={data:function(){return{hoadon:{mahd:0,tenkh:"",diachi:"",sdt:"",dathanhtoan:0,ngaylap:new Date((new Date).getTime()).toISOString().substr(0,10),nocu:0,tongtien:0}}},methods:{themmoi:function(t){var n=this;t.preventDefault(),this.hoadon.mahd=(new Date).getTime(),l.db.collection("hoadon").add(this.hoadon).then((function(){alert("Thêm mới hóa đơn thành công!"),n.hoadon={mahd:0,tenkh:"",diachi:"",sdt:"",dathanhtoan:0,ngaylap:new Date((new Date).getTime()).toISOString().substr(0,10),nocu:0,tongtien:0}})).catch((function(t){alert("Có lỗi xảy ra vui lòng thử lại sau!"),console.log(t)}))}}},h=d,m=a(1001),p=(0,m.Z)(h,c,u,!1,null,null,null),f=p.exports,v=function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"row justify-content-center"},[a("div",{},[a("h3",{staticClass:"text-center"},[t._v("Cập nhật hóa đơn")]),a("form",{on:{submit:function(n){return n.preventDefault(),t.capnhat.apply(null,arguments)}}},[a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Tên khách hàng")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.tenkh,expression:"hoadon.tenkh"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.tenkh},on:{input:function(n){n.target.composing||t.$set(t.hoadon,"tenkh",n.target.value)}}})]),a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Số điện thoại")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.sdt,expression:"hoadon.sdt"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.sdt},on:{input:function(n){n.target.composing||t.$set(t.hoadon,"sdt",n.target.value)}}})]),a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Địa chỉ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.diachi,expression:"hoadon.diachi"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.diachi},on:{input:function(n){n.target.composing||t.$set(t.hoadon,"diachi",n.target.value)}}})]),a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Ngày")]),a("b-form-datepicker",{attrs:{"date-format-options":{year:"numeric",month:"numeric",day:"numeric"},locale:"en"},model:{value:t.hoadon.ngaylap,callback:function(n){t.$set(t.hoadon,"ngaylap",n)},expression:"hoadon.ngaylap"}})],1),a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Đã thanh toán")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.dathanhtoan,expression:"hoadon.dathanhtoan"}],staticClass:"form-control",attrs:{type:"number",required:""},domProps:{value:t.hoadon.dathanhtoan},on:{input:function(n){n.target.composing||t.$set(t.hoadon,"dathanhtoan",n.target.value)}}})]),a("div",{staticClass:"form-group mt-2"},[a("label",[t._v("Nợ cũ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.nocu,expression:"hoadon.nocu"}],staticClass:"form-control",attrs:{type:"number",required:""},domProps:{value:t.hoadon.nocu},on:{input:function(n){n.target.composing||t.$set(t.hoadon,"nocu",n.target.value)}}})]),t._m(0)])])])},g=[function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"form-group mt-2 mt-2"},[a("button",{staticClass:"btn btn-success btn-block"},[t._v("Cập nhật")])])}],b=(a(8862),{props:["hoadon_item"],data:function(){return{hoadon:{id:"",mahd:0,tenkh:"",diachi:"",sdt:"",dathanhtoan:0,ngaylap:new Date((new Date).getTime()).toISOString().substr(0,10),nocu:0,tongtien:0}}},created:function(){this.hoadon=JSON.parse(JSON.stringify(this.hoadon_item))},methods:{capnhat:function(t){t.preventDefault(),l.db.collection("hoadon").doc(this.hoadon.key).update(this.hoadon).then((function(){alert("Cập nhật thành công!")})).catch((function(t){alert("Có lỗi xảy ra vui lòng thử lại sau!"),console.log(t)}))}}}),_=b,y=(0,m.Z)(_,v,g,!1,null,null,null),k=y.exports,C={data:function(){return{show_popup_them_moi:!1,show_popup_sua:!1,filter:null,perPage:20,currentPage:1,danh_sach_hoa_don:[],fields_table:[{key:"stt",label:"STT",sortable:!0},{key:"ngaylap",label:"Ngày lập",sortable:!0},{key:"tenkh",label:"Tên KH",sortable:!0},{key:"diachi",label:"Địa chỉ",sortable:!0},{key:"sdt",label:"Số điện thoại",sortable:!0},{key:"nocu",label:"Nợ cũ",sortable:!0},{key:"dathanhtoan",label:"Đã thanh toán",sortable:!0},{key:"tongtien",label:"Tổng tiền",sortable:!0},{key:"key",label:"Hành động",sortable:!0}],hoadon_item_selected:{}}},components:{themmoi:f,sua:k},created:function(){var t=this;l.db.collection("hoadon").onSnapshot((function(n){t.danh_sach_hoa_don=[];var a=0;n.forEach((function(n){var e=[];l.db.collection("chitiethoadon").where("mahd","==",n.data().mahd+"").onSnapshot((function(t){t.forEach((function(t){e.push(t.data())}))})),a++,t.danh_sach_hoa_don.push({key:n.id,stt:a,mahd:n.data().mahd,tenkh:n.data().tenkh,diachi:n.data().diachi,sdt:n.data().sdt,dathanhtoan:n.data().dathanhtoan,ngaylap:n.data().ngaylap,nocu:n.data().nocu,tongtien:n.data().tongtien,cthd:e})}))}))},methods:{deleteHoadon:function(t){window.confirm("Bạn có chắc chắn muốn xóa không?")&&l.db.collection("hoadon").doc(t).delete().then((function(){console.log("Đã xóa hóa đơn!")})).catch((function(t){console.error(t)}))},formatMoney:function(t,n,a){var e=parseFloat(t);return isNaN(e)?t:(t=parseFloat(t),t.toLocaleString("en",{minimumFractionDigits:n,maximumFractionDigits:a}))},sum_arr:function(t){var n,a=0,e=s(t);try{for(e.s();!(n=e.n()).done;){var o=n.value;a+=o}}catch(r){e.e(r)}finally{e.f()}return a}}},w=C,x=(0,m.Z)(w,e,o,!1,null,null,null),N=x.exports}}]);
//# sourceMappingURL=306-legacy.76b64a00.js.map