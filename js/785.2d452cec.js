"use strict";(self["webpackChunkvue_firebase_crud_app"]=self["webpackChunkvue_firebase_crud_app"]||[]).push([[785],{7785:function(t,a,e){e.r(a),e.d(a,{default:function(){return C}});var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"row"},[e("div",[e("b-button",{staticClass:"float-right",attrs:{variant:"success"},on:{click:function(a){t.show_popup_them_moi=!0}}},[t._v("Thêm mới hóa đơn")]),e("b-modal",{attrs:{title:"Thêm mới hóa đơn",size:"lg"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[e("div",{staticClass:"w-100"},[e("b-button",{staticClass:"float-right",attrs:{variant:"primary",size:"sm"},on:{click:function(a){t.show_popup_them_moi=!1}}},[t._v(" Đóng ")])],1)]},proxy:!0}]),model:{value:t.show_popup_them_moi,callback:function(a){t.show_popup_them_moi=a},expression:"show_popup_them_moi"}},[e("themmoi")],1),e("b-modal",{attrs:{title:"Cập nhật hóa đơn",size:"lg"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[e("div",{staticClass:"w-100"},[e("b-button",{staticClass:"float-right",attrs:{variant:"primary",size:"sm"},on:{click:function(a){t.show_popup_sua=!1}}},[t._v(" Đóng ")])],1)]},proxy:!0}]),model:{value:t.show_popup_sua,callback:function(a){t.show_popup_sua=a},expression:"show_popup_sua"}},[e("sua",{attrs:{hoadon_item:t.hoadon_item_selected}})],1)],1),e("div",{staticClass:"col-md-12"},[e("p",{staticClass:"h5 font-weight-bold text-center"},[t._v("Danh sách hóa đơn")]),e("b-form-group",{staticClass:"my-2",attrs:{label:"Tìm kiếm","label-for":"filter-input"}},[e("b-input-group",{attrs:{size:"sm"}},[e("b-form-input",{attrs:{id:"filter-input",type:"search",placeholder:"Nhập từ khóa để tìm kiếm"},model:{value:t.filter,callback:function(a){t.filter=a},expression:"filter"}}),e("b-input-group-append",[e("b-button",{attrs:{disabled:!t.filter},on:{click:function(a){t.filter=""}}},[t._v("Xóa")])],1)],1)],1),e("b-table",{staticClass:"table-hoadon",attrs:{striped:"",hover:"",items:t.danh_sach_hoa_don,fields:t.fields_table,filter:t.filter,"per-page":t.perPage,"current-page":t.currentPage,id:"my-table"},scopedSlots:t._u([{key:"cell(stt)",fn:function(a){return[t._v(" "+t._s(a.item.stt)+" ")]}},{key:"cell(nocu)",fn:function(a){return[t._v(" "+t._s(t.formatMoney(a.item.nocu,0,2))+" VNĐ ")]}},{key:"cell(dathanhtoan)",fn:function(a){return[t._v(" "+t._s(t.formatMoney(a.item.dathanhtoan,0,2))+" VNĐ ")]}},{key:"cell(tongtien)",fn:function(a){return[t._v(" "+t._s(t.formatMoney(t.sum_arr(a.item.cthd.map((function(t){return parseFloat(t.thanhtien)}))),0,2))+" VNĐ ")]}},{key:"cell(key)",fn:function(a){return[e("button",{staticClass:"btn btn-primary",on:{click:function(e){return e.preventDefault(),t.$router.push("/chi-tiet-hoa-don/"+a.item.mahd)}}},[t._v(" Chi tiết ")]),e("button",{staticClass:"btn btn-info",on:{click:function(e){e.preventDefault(),t.hoadon_item_selected=JSON.parse(JSON.stringify(a.item)),t.show_popup_sua=!0}}},[t._v(" Sửa ")]),e("button",{staticClass:"btn btn-danger ml-2",on:{click:function(e){return e.preventDefault(),t.deleteHoadon(a.item.key)}}},[t._v(" Xóa ")])]}}])}),e("b-pagination",{attrs:{"total-rows":t.danh_sach_hoa_don.length,"per-page":t.perPage,"aria-controls":"my-table"},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1)])},n=[],s=e(4805),i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"row justify-content-center"},[e("div",{},[e("h3",{staticClass:"text-center"},[t._v("Thêm mới hóa đơn")]),e("form",{on:{submit:function(a){return a.preventDefault(),t.themmoi.apply(null,arguments)}}},[e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Tên khách hàng")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.tenkh,expression:"hoadon.tenkh"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.tenkh},on:{input:function(a){a.target.composing||t.$set(t.hoadon,"tenkh",a.target.value)}}})]),e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Số điện thoại")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.sdt,expression:"hoadon.sdt"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.sdt},on:{input:function(a){a.target.composing||t.$set(t.hoadon,"sdt",a.target.value)}}})]),e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Địa chỉ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.diachi,expression:"hoadon.diachi"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.diachi},on:{input:function(a){a.target.composing||t.$set(t.hoadon,"diachi",a.target.value)}}})]),e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Ngày")]),e("b-form-datepicker",{attrs:{"date-format-options":{year:"numeric",month:"numeric",day:"numeric"},locale:"en"},model:{value:t.hoadon.ngaylap,callback:function(a){t.$set(t.hoadon,"ngaylap",a)},expression:"hoadon.ngaylap"}})],1),e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Đã thanh toán")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.dathanhtoan,expression:"hoadon.dathanhtoan"}],staticClass:"form-control",attrs:{type:"number",required:""},domProps:{value:t.hoadon.dathanhtoan},on:{input:function(a){a.target.composing||t.$set(t.hoadon,"dathanhtoan",a.target.value)}}})]),e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Nợ cũ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.nocu,expression:"hoadon.nocu"}],staticClass:"form-control",attrs:{type:"number",required:""},domProps:{value:t.hoadon.nocu},on:{input:function(a){a.target.composing||t.$set(t.hoadon,"nocu",a.target.value)}}})]),t._m(0)])])])},r=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"form-group mt-2 mt-2"},[e("button",{staticClass:"btn btn-success btn-block"},[t._v("Thêm mới")])])}],l={data(){return{hoadon:{mahd:0,tenkh:"",diachi:"",sdt:"",dathanhtoan:0,ngaylap:new Date((new Date).getTime()).toISOString().substr(0,10),nocu:0,tongtien:0}}},methods:{themmoi(t){t.preventDefault(),this.hoadon.mahd=(new Date).getTime(),s.db.collection("hoadon").add(this.hoadon).then((()=>{alert("Thêm mới hóa đơn thành công!"),this.hoadon={mahd:0,tenkh:"",diachi:"",sdt:"",dathanhtoan:0,ngaylap:new Date((new Date).getTime()).toISOString().substr(0,10),nocu:0,tongtien:0}})).catch((t=>{alert("Có lỗi xảy ra vui lòng thử lại sau!"),console.log(t)}))}}},c=l,d=e(1001),h=(0,d.Z)(c,i,r,!1,null,null,null),u=h.exports,m=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"row justify-content-center"},[e("div",{},[e("h3",{staticClass:"text-center"},[t._v("Cập nhật hóa đơn")]),e("form",{on:{submit:function(a){return a.preventDefault(),t.capnhat.apply(null,arguments)}}},[e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Tên khách hàng")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.tenkh,expression:"hoadon.tenkh"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.tenkh},on:{input:function(a){a.target.composing||t.$set(t.hoadon,"tenkh",a.target.value)}}})]),e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Số điện thoại")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.sdt,expression:"hoadon.sdt"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.sdt},on:{input:function(a){a.target.composing||t.$set(t.hoadon,"sdt",a.target.value)}}})]),e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Địa chỉ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.diachi,expression:"hoadon.diachi"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.hoadon.diachi},on:{input:function(a){a.target.composing||t.$set(t.hoadon,"diachi",a.target.value)}}})]),e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Ngày")]),e("b-form-datepicker",{attrs:{"date-format-options":{year:"numeric",month:"numeric",day:"numeric"},locale:"en"},model:{value:t.hoadon.ngaylap,callback:function(a){t.$set(t.hoadon,"ngaylap",a)},expression:"hoadon.ngaylap"}})],1),e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Đã thanh toán")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.dathanhtoan,expression:"hoadon.dathanhtoan"}],staticClass:"form-control",attrs:{type:"number",required:""},domProps:{value:t.hoadon.dathanhtoan},on:{input:function(a){a.target.composing||t.$set(t.hoadon,"dathanhtoan",a.target.value)}}})]),e("div",{staticClass:"form-group mt-2"},[e("label",[t._v("Nợ cũ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hoadon.nocu,expression:"hoadon.nocu"}],staticClass:"form-control",attrs:{type:"number",required:""},domProps:{value:t.hoadon.nocu},on:{input:function(a){a.target.composing||t.$set(t.hoadon,"nocu",a.target.value)}}})]),t._m(0)])])])},p=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"form-group mt-2 mt-2"},[e("button",{staticClass:"btn btn-success btn-block"},[t._v("Cập nhật")])])}],f={props:["hoadon_item"],data(){return{hoadon:{id:"",mahd:0,tenkh:"",diachi:"",sdt:"",dathanhtoan:0,ngaylap:new Date((new Date).getTime()).toISOString().substr(0,10),nocu:0,tongtien:0}}},created(){this.hoadon=JSON.parse(JSON.stringify(this.hoadon_item))},methods:{capnhat(t){t.preventDefault(),s.db.collection("hoadon").doc(this.hoadon.key).update(this.hoadon).then((()=>{alert("Cập nhật thành công!")})).catch((t=>{alert("Có lỗi xảy ra vui lòng thử lại sau!"),console.log(t)}))}}},v=f,g=(0,d.Z)(v,m,p,!1,null,null,null),_=g.exports,b={data(){return{show_popup_them_moi:!1,show_popup_sua:!1,filter:null,perPage:20,currentPage:1,danh_sach_hoa_don:[],fields_table:[{key:"stt",label:"STT",sortable:!0},{key:"ngaylap",label:"Ngày lập",sortable:!0},{key:"tenkh",label:"Tên KH",sortable:!0},{key:"diachi",label:"Địa chỉ",sortable:!0},{key:"sdt",label:"Số điện thoại",sortable:!0},{key:"nocu",label:"Nợ cũ",sortable:!0},{key:"dathanhtoan",label:"Đã thanh toán",sortable:!0},{key:"tongtien",label:"Tổng tiền",sortable:!0},{key:"key",label:"Hành động",sortable:!0}],hoadon_item_selected:{}}},components:{themmoi:u,sua:_},created(){s.db.collection("hoadon").onSnapshot((t=>{this.danh_sach_hoa_don=[];let a=0;t.forEach((t=>{let e=[];s.db.collection("chitiethoadon").where("mahd","==",t.data().mahd+"").onSnapshot((t=>{t.forEach((t=>{e.push(t.data())}))})),a++,this.danh_sach_hoa_don.push({key:t.id,stt:a,mahd:t.data().mahd,tenkh:t.data().tenkh,diachi:t.data().diachi,sdt:t.data().sdt,dathanhtoan:t.data().dathanhtoan,ngaylap:t.data().ngaylap,nocu:t.data().nocu,tongtien:t.data().tongtien,cthd:e})}))}))},methods:{deleteHoadon(t){window.confirm("Bạn có chắc chắn muốn xóa không?")&&s.db.collection("hoadon").doc(t).delete().then((()=>{console.log("Đã xóa hóa đơn!")})).catch((t=>{console.error(t)}))},formatMoney(t,a,e){let o=parseFloat(t);return isNaN(o)?t:(t=parseFloat(t),t.toLocaleString("en",{minimumFractionDigits:a,maximumFractionDigits:e}))},sum_arr(t){let a=0;for(const e of t)a+=e;return a}}},y=b,k=(0,d.Z)(y,o,n,!1,null,null,null),C=k.exports}}]);
//# sourceMappingURL=785.2d452cec.js.map