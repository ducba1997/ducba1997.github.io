(self["webpackChunkvue_firebase_crud_app"]=self["webpackChunkvue_firebase_crud_app"]||[]).push([[805],{1223:function(t,e,n){var r=n(5112),i=n(30),o=n(3070),s=r("unscopables"),a=Array.prototype;void 0==a[s]&&o.f(a,s,{configurable:!0,value:i(null)}),t.exports=function(t){a[s][t]=!0}},5787:function(t,e,n){var r=n(7854),i=n(7976),o=r.TypeError;t.exports=function(t,e){if(i(e,t))return t;throw o("Incorrect invocation")}},4019:function(t){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},260:function(t,e,n){"use strict";var r,i,o,s=n(4019),a=n(9781),u=n(7854),c=n(614),h=n(111),l=n(2597),f=n(648),p=n(6330),d=n(8880),y=n(1320),v=n(3070).f,g=n(7976),m=n(9518),b=n(7674),w=n(5112),E=n(9711),I=u.Int8Array,_=I&&I.prototype,T=u.Uint8ClampedArray,S=T&&T.prototype,A=I&&m(I),N=_&&m(_),D=Object.prototype,C=u.TypeError,R=w("toStringTag"),k=E("TYPED_ARRAY_TAG"),O=E("TYPED_ARRAY_CONSTRUCTOR"),x=s&&!!b&&"Opera"!==f(u.opera),L=!1,P={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},M={BigInt64Array:8,BigUint64Array:8},F=function(t){if(!h(t))return!1;var e=f(t);return"DataView"===e||l(P,e)||l(M,e)},V=function(t){if(!h(t))return!1;var e=f(t);return l(P,e)||l(M,e)},U=function(t){if(V(t))return t;throw C("Target is not a typed array")},q=function(t){if(c(t)&&(!b||g(A,t)))return t;throw C(p(t)+" is not a typed array constructor")},j=function(t,e,n,r){if(a){if(n)for(var i in P){var o=u[i];if(o&&l(o.prototype,t))try{delete o.prototype[t]}catch(s){try{o.prototype[t]=e}catch(c){}}}N[t]&&!n||y(N,t,n?e:x&&_[t]||e,r)}},B=function(t,e,n){var r,i;if(a){if(b){if(n)for(r in P)if(i=u[r],i&&l(i,t))try{delete i[t]}catch(o){}if(A[t]&&!n)return;try{return y(A,t,n?e:x&&A[t]||e)}catch(o){}}for(r in P)i=u[r],!i||i[t]&&!n||y(i,t,e)}};for(r in P)i=u[r],o=i&&i.prototype,o?d(o,O,i):x=!1;for(r in M)i=u[r],o=i&&i.prototype,o&&d(o,O,i);if((!x||!c(A)||A===Function.prototype)&&(A=function(){throw C("Incorrect invocation")},x))for(r in P)u[r]&&b(u[r],A);if((!x||!N||N===D)&&(N=A.prototype,x))for(r in P)u[r]&&b(u[r].prototype,N);if(x&&m(S)!==N&&b(S,N),a&&!l(N,R))for(r in L=!0,v(N,R,{get:function(){return h(this)?this[k]:void 0}}),P)u[r]&&d(u[r],k,r);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:x,TYPED_ARRAY_CONSTRUCTOR:O,TYPED_ARRAY_TAG:L&&k,aTypedArray:U,aTypedArrayConstructor:q,exportTypedArrayMethod:j,exportTypedArrayStaticMethod:B,isView:F,isTypedArray:V,TypedArray:A,TypedArrayPrototype:N}},8544:function(t,e,n){var r=n(7293);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},3678:function(t){t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},30:function(t,e,n){var r,i=n(9670),o=n(6048),s=n(748),a=n(3501),u=n(490),c=n(317),h=n(6200),l=">",f="<",p="prototype",d="script",y=h("IE_PROTO"),v=function(){},g=function(t){return f+d+l+t+f+"/"+d+l},m=function(t){t.write(g("")),t.close();var e=t.parentWindow.Object;return t=null,e},b=function(){var t,e=c("iframe"),n="java"+d+":";return e.style.display="none",u.appendChild(e),e.src=String(n),t=e.contentWindow.document,t.open(),t.write(g("document.F=Object")),t.close(),t.F},w=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}w="undefined"!=typeof document?document.domain&&r?m(r):b():m(r);var t=s.length;while(t--)delete w[p][s[t]];return w()};a[y]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(v[p]=i(t),n=new v,v[p]=null,n[y]=t):n=w(),void 0===e?n:o.f(n,e)}},6048:function(t,e,n){var r=n(9781),i=n(3353),o=n(3070),s=n(9670),a=n(5656),u=n(1956);e.f=r&&!i?Object.defineProperties:function(t,e){s(t);var n,r=a(e),i=u(e),c=i.length,h=0;while(c>h)o.f(t,n=i[h++],r[n]);return t}},9518:function(t,e,n){var r=n(7854),i=n(2597),o=n(614),s=n(7908),a=n(6200),u=n(8544),c=a("IE_PROTO"),h=r.Object,l=h.prototype;t.exports=u?h.getPrototypeOf:function(t){var e=s(t);if(i(e,c))return e[c];var n=e.constructor;return o(n)&&e instanceof n?n.prototype:e instanceof h?l:null}},1956:function(t,e,n){var r=n(6324),i=n(748);t.exports=Object.keys||function(t){return r(t,i)}},4590:function(t,e,n){var r=n(7854),i=n(3002),o=r.RangeError;t.exports=function(t,e){var n=i(t);if(n%e)throw o("Wrong offset");return n}},3002:function(t,e,n){var r=n(7854),i=n(9303),o=r.RangeError;t.exports=function(t){var e=i(t);if(e<0)throw o("The argument can't be less than 0");return e}},2262:function(t,e,n){"use strict";var r=n(2109),i=n(7908),o=n(6244),s=n(9303),a=n(1223);r({target:"Array",proto:!0},{at:function(t){var e=i(this),n=o(e),r=s(t),a=r>=0?r:n+r;return a<0||a>=n?void 0:e[a]}}),a("at")},4506:function(t,e,n){"use strict";var r=n(2109),i=n(1702),o=n(4488),s=n(9303),a=n(1340),u=n(7293),c=i("".charAt),h=u((function(){return"\ud842"!=="ð ®·".at(-2)}));r({target:"String",proto:!0,forced:h},{at:function(t){var e=a(o(this)),n=e.length,r=s(t),i=r>=0?r:n+r;return i<0||i>=n?void 0:c(e,i)}})},8675:function(t,e,n){"use strict";var r=n(260),i=n(6244),o=n(9303),s=r.aTypedArray,a=r.exportTypedArrayMethod;a("at",(function(t){var e=s(this),n=i(e),r=o(t),a=r>=0?r:n+r;return a<0||a>=n?void 0:e[a]}))},3462:function(t,e,n){"use strict";var r=n(7854),i=n(6916),o=n(260),s=n(6244),a=n(4590),u=n(7908),c=n(7293),h=r.RangeError,l=r.Int8Array,f=l&&l.prototype,p=f&&f.set,d=o.aTypedArray,y=o.exportTypedArrayMethod,v=!c((function(){var t=new Uint8ClampedArray(2);return i(p,t,{length:1,0:3},1),3!==t[1]})),g=v&&o.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var t=new l(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));y("set",(function(t){d(this);var e=a(arguments.length>1?arguments[1]:void 0,1),n=u(t);if(v)return i(p,this,n,e);var r=this.length,o=s(n),c=0;if(o+e>r)throw h("Wrong length");while(c<o)this[e+c]=n[c++]}),!v||g)},2801:function(t,e,n){"use strict";var r=n(2109),i=n(5005),o=n(9114),s=n(3070).f,a=n(2597),u=n(5787),c=n(9587),h=n(6277),l=n(3678),f=n(7741),p=n(1913),d="DOMException",y=i("Error"),v=i(d),g=function(){u(this,m);var t=arguments.length,e=h(t<1?void 0:arguments[0]),n=h(t<2?void 0:arguments[1],"Error"),r=new v(e,n),i=y(e);return i.name=d,s(r,"stack",o(1,f(i.stack,1))),c(r,this,g),r},m=g.prototype=v.prototype,b="stack"in y(d),w="stack"in new v(1,2),E=b&&!w;r({global:!0,forced:p||E},{DOMException:E?g:v});var I=i(d),_=I.prototype;if(_.constructor!==I)for(var T in p||s(_,"constructor",o(1,I)),l)if(a(l,T)){var S=l[T],A=S.s;a(I,A)||s(I,A,o(6,S.c))}},4805:function(t,e,n){"use strict";n.d(e,{db:function(){return Vy}});n(1703);var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)};function i(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)};function s(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}Object.create;function u(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return s}function h(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}Object.create;n(2801);var l=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},f=function(t){var e=[],n=0,r=0;while(n<t.length){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){o=t[n++];var s=t[n++],a=t[n++],u=((7&i)<<18|(63&o)<<12|(63&s)<<6|63&a)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(1023&u))}else{o=t[n++],s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")},p={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(l(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):f(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length,a=s?n[t.charAt(i)]:0;++i;var u=i<t.length,c=u?n[t.charAt(i)]:64;++i;var h=i<t.length,l=h?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==c||null==l)throw Error();var f=o<<2|a>>4;if(r.push(f),64!==c){var p=a<<4&240|c>>2;if(r.push(p),64!==l){var d=c<<6&192|l;r.push(d)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},d=function(t){var e=l(t);return p.encodeByteArray(e,!0)},y=function(t){return d(t).replace(/\./g,"")};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function v(t){return g(void 0,t)}function g(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:var n=e;return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var r in e)e.hasOwnProperty(r)&&m(r)&&(t[r]=g(t[r],e[r]));return t}function m(t){return"__proto__"!==t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var b=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"===typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=o({iss:"https://securetoken.google.com/"+r,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),u="";return[y(JSON.stringify(n)),y(JSON.stringify(a)),u].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E(){return"undefined"!==typeof navigator&&"string"===typeof navigator["userAgent"]?navigator["userAgent"]:""}function I(){return"undefined"!==typeof window&&!!(window["cordova"]||window["phonegap"]||window["PhoneGap"])&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(E())}function _(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function T(){return"object"===typeof self&&self.self===self}function S(){var t="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof t&&void 0!==t.id}function A(){return"object"===typeof navigator&&"ReactNative"===navigator["product"]}function N(){return E().indexOf("Electron/")>=0}function D(){var t=E();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function C(){return E().indexOf("MSAppHost/")>=0}function R(){return!_()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var k="FirebaseError",O=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name=k,Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,x.prototype.create),o}return i(e,t),e}(Error),x=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?L(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new O(i,a,r);return u},t}();function L(t,e){return t.replace(P,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var P=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
(function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),s=1518500249):(o=u^c^h,s=1859775393):r<60?(o=u&c|h&(u|c),s=2400959708):(o=u^c^h,s=3395469782);i=(a<<5|a>>>27)+o+l+s+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;while(r<e){if(0===o)while(r<=n)this.compress_(t,r),r+=this.blockSize;if("string"===typeof t){while(r<e)if(i[o]=t.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else while(r<e)if(i[o]=t[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}})();function F(t,e){var n=new V(t,e);return n.subscribe.bind(n)}var V=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=U(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=q),void 0===r.error&&(r.error=q),void 0===r.complete&&(r.complete=q);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function U(t,e){if("object"!==typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"===typeof t[i])return!0}return!1}function q(){}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function j(t){return t&&t._delegate?t._delegate:t}var B=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),K="[DEFAULT]",z=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new b;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),r=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(H(t))try{this.getOrInitializeService({instanceIdentifier:K})}catch(f){}try{for(var r=u(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=c(i.value,2),s=o[0],a=o[1],h=this.normalizeInstanceIdentifier(s);try{var l=this.getOrInitializeService({instanceIdentifier:h});a.resolve(l)}catch(f){}}}catch(p){e={error:p}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=K),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return s(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(h(h([],c(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),c(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=K),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=K),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=u(this.instancesDeferred.entries()),h=a.next();!h.done;h=a.next()){var l=c(h.value,2),f=l[0],p=l[1],d=this.normalizeInstanceIdentifier(f);o===d&&p.resolve(s)}}catch(y){e={error:y}}finally{try{h&&!h.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=u(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(c){}}}catch(h){n={error:h}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e=t.instanceIdentifier,n=t.options,r=void 0===n?{}:n,i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:G(e),options:r}),this.instances.set(e,i),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch(py){}return i||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=K),this.component?this.component.multipleInstances?t:K:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G(t){return t===K?void 0:t}function H(t){return"EAGER"===t.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Q,W=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){var e=this.getProvider(t.name);e.isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new z(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function Y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var X,$=[];(function(t){t[t["DEBUG"]=0]="DEBUG",t[t["VERBOSE"]=1]="VERBOSE",t[t["INFO"]=2]="INFO",t[t["WARN"]=3]="WARN",t[t["ERROR"]=4]="ERROR",t[t["SILENT"]=5]="SILENT"})(X||(X={}));var J,Z={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},tt=X.INFO,et=(Q={},Q[X.DEBUG]="log",Q[X.VERBOSE]="log",Q[X.INFO]="info",Q[X.WARN]="warn",Q[X.ERROR]="error",Q),nt=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=et[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,Y(["["+i+"]  "+t.name+":"],n))}},rt=function(){function t(t){this.name=t,this._logLevel=tt,this._logHandler=nt,this._userLogHandler=null,$.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in X))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"===typeof t?Z[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Y([this,X.DEBUG],t)),this._logHandler.apply(this,Y([this,X.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Y([this,X.VERBOSE],t)),this._logHandler.apply(this,Y([this,X.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Y([this,X.INFO],t)),this._logHandler.apply(this,Y([this,X.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Y([this,X.WARN],t)),this._logHandler.apply(this,Y([this,X.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Y([this,X.ERROR],t)),this._logHandler.apply(this,Y([this,X.ERROR],t))},t}();function it(t){$.forEach((function(e){e.setLogLevel(t)}))}function ot(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=Z[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"===typeof t)return t;if("number"===typeof t||"boolean"===typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!==r&&void 0!==r?r:e.logLevel)&&t({level:X[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=$;r<i.length;r++){var o=i[r];n(o)}}var st,at=(J={},J["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",J["bad-app-name"]="Illegal App name: '{$appName}",J["duplicate-app"]="Firebase App named '{$appName}' already exists",J["app-deleted"]="Firebase App named '{$appName}' already deleted",J["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",J["invalid-log-argument"]="First argument to `onLog` must be null or a function.",J),ut=new x("app","Firebase",at),ct="@firebase/app",ht="0.6.30",lt="@firebase/analytics",ft="@firebase/app-check",pt="@firebase/auth",dt="@firebase/database",yt="@firebase/functions",vt="@firebase/installations",gt="@firebase/messaging",mt="@firebase/performance",bt="@firebase/remote-config",wt="@firebase/storage",Et="@firebase/firestore",It="firebase-wrapper",_t="[DEFAULT]",Tt=(st={},st[ct]="fire-core",st[lt]="fire-analytics",st[ft]="fire-app-check",st[pt]="fire-auth",st[dt]="fire-rtdb",st[yt]="fire-fn",st[vt]="fire-iid",st[gt]="fire-fcm",st[mt]="fire-perf",st[bt]="fire-rc",st[wt]="fire-gcs",st[Et]="fire-fst",st["fire-js"]="fire-js",st[It]="fire-js-all",st),St=new rt("@firebase/app"),At=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=v(t),this.container=new W(e.name),this._addComponent(new B("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=_t),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=_t),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){St.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw ut.create("app-deleted",{appName:this.name_})},t}();At.prototype.name&&At.prototype.options||At.prototype.delete||console.log("dc");var Nt="8.10.0";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(t){var e={},n=new Map,r={__esModule:!0,initializeApp:s,app:o,registerVersion:c,setLogLevel:it,onLog:h,apps:null,SDK_VERSION:Nt,INTERNAL:{registerComponent:u,removeApp:i,components:n,useAsService:l}};function i(t){delete e[t]}function o(t){if(t=t||_t,!M(e,t))throw ut.create("no-app",{appName:t});return e[t]}function s(n,i){if(void 0===i&&(i={}),"object"!==typeof i||null===i){var o=i;i={name:o}}var s=i;void 0===s.name&&(s.name=_t);var a=s.name;if("string"!==typeof a||!a)throw ut.create("bad-app-name",{appName:String(a)});if(M(e,a))throw ut.create("duplicate-app",{appName:a});var u=new t(n,s,r);return e[a]=u,u}function a(){return Object.keys(e).map((function(t){return e[t]}))}function u(i){var s=i.name;if(n.has(s))return St.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===i.type?r[s]:null;if(n.set(s,i),"PUBLIC"===i.type){var a=function(t){if(void 0===t&&(t=o()),"function"!==typeof t[s])throw ut.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==i.serviceProps&&g(a,i.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,i.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var h=c[u];e[h]._addComponent(i)}return"PUBLIC"===i.type?r[s]:null}function c(t,e,n){var r,i=null!==(r=Tt[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var a=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&a.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&a.push("and"),s&&a.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void St.warn(a.join(" "))}u(new B(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))}function h(t,e){if(null!==t&&"function"!==typeof t)throw ut.create("invalid-log-argument");ot(t,e)}function l(t,e){if("serverAuth"===e)return null;var n=e;return n}return r["default"]=r,Object.defineProperty(r,"apps",{get:a}),o["App"]=t,r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(){var t=Dt(At);function e(e){g(t,e)}return t.INTERNAL=o(o({},t.INTERNAL),{createFirebaseNamespace:Ct,extendNamespace:e,createSubscribe:F,ErrorFactory:x,deepExtend:g}),t}var Rt=Ct(),kt=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){var t=this.container.getProviders();return t.map((function(t){if(Ot(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(t){var e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t,e){t.INTERNAL.registerComponent(new B("platform-logger",(function(t){return new kt(t)}),"PRIVATE")),t.registerVersion(ct,ht,e),t.registerVersion("fire-js","")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(T()&&void 0!==self.firebase){St.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Lt=self.firebase.SDK_VERSION;Lt&&Lt.indexOf("LITE")>=0&&St.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Pt=Rt.initializeApp;Rt.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return _()&&St.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Pt.apply(void 0,t)};var Mt=Rt;xt(Mt);var Ft=Mt,Vt="firebase",Ut="8.10.1";
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Ft.registerVersion(Vt,Ut,"app"),Ft.SDK_VERSION=Ut;n(8675),n(3462),n(2262),n(4506);var qt=function(t,e){return qt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},qt(t,e)};function jt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}qt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Bt(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Kt,zt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Gt=Gt||{},Ht=zt||self;function Qt(){}function Wt(t){var e=typeof t;return e="object"!=e?e:t?Array.isArray(t)?"array":e:"null","array"==e||"object"==e&&"number"==typeof t.length}function Yt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function Xt(t){return Object.prototype.hasOwnProperty.call(t,$t)&&t[$t]||(t[$t]=++Jt)}var $t="closure_uid_"+(1e9*Math.random()>>>0),Jt=0;function Zt(t,e,n){return t.call.apply(t.bind,arguments)}function te(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ee(t,e,n){return ee=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Zt:te,ee.apply(null,arguments)}function ne(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function re(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ie(){this.s=this.s,this.o=this.o}var oe=0,se={};ie.prototype.s=!1,ie.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0!=oe)){var t=Xt(this);delete se[t]}},ie.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var ae=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ue=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"===typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function ce(t){t:{for(var e=Ni,n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}function he(t){return Array.prototype.concat.apply([],arguments)}function le(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function fe(t){return/^[\s\xa0]*$/.test(t)}var pe,de=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ye(t,e){return-1!=t.indexOf(e)}function ve(t,e){return t<e?-1:t>e?1:0}t:{var ge=Ht.navigator;if(ge){var me=ge.userAgent;if(me){pe=me;break t}}pe=""}function be(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function we(t){var e={};for(var n in t)e[n]=t[n];return e}var Ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ie(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(var o=0;o<Ee.length;o++)n=Ee[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function _e(t){return _e[" "](t),t}function Te(t){var e=Fe;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}_e[" "]=Qt;var Se,Ae=ye(pe,"Opera"),Ne=ye(pe,"Trident")||ye(pe,"MSIE"),De=ye(pe,"Edge"),Ce=De||Ne,Re=ye(pe,"Gecko")&&!(ye(pe.toLowerCase(),"webkit")&&!ye(pe,"Edge"))&&!(ye(pe,"Trident")||ye(pe,"MSIE"))&&!ye(pe,"Edge"),ke=ye(pe.toLowerCase(),"webkit")&&!ye(pe,"Edge");function Oe(){var t=Ht.document;return t?t.documentMode:void 0}t:{var xe="",Le=function(){var t=pe;return Re?/rv:([^\);]+)(\)|;)/.exec(t):De?/Edge\/([\d\.]+)/.exec(t):Ne?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):ke?/WebKit\/(\S+)/.exec(t):Ae?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Le&&(xe=Le?Le[1]:""),Ne){var Pe=Oe();if(null!=Pe&&Pe>parseFloat(xe)){Se=String(Pe);break t}}Se=xe}var Me,Fe={};function Ve(){return Te((function(){for(var t=0,e=de(String(Se)).split("."),n=de("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=ve(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||ve(0==o[2].length,0==s[2].length)||ve(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(Ht.document&&Ne){var Ue=Oe();Me=Ue||(parseInt(Se,10)||void 0)}else Me=void 0;var qe=Me,je=function(){if(!Ht.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Ht.addEventListener("test",Qt,e),Ht.removeEventListener("test",Qt,e)}catch(n){}return t}();function Be(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Ke(t,e){if(Be.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Re){t:{try{_e(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:ze[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ke.Z.h.call(this)}}Be.prototype.h=function(){this.defaultPrevented=!0},re(Ke,Be);var ze={2:"touch",3:"pen",4:"mouse"};Ke.prototype.h=function(){Ke.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Ge="closure_listenable_"+(1e6*Math.random()|0),He=0;function Qe(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++He,this.ca=this.fa=!1}function We(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Ye(t){this.src=t,this.g={},this.h=0}function Xe(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=ae(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(We(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function $e(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Ye.prototype.add=function(t,e,n,r,i){var o=t.toString();t=this.g[o],t||(t=this.g[o]=[],this.h++);var s=$e(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):(e=new Qe(e,this.src,o,!!r,i),e.fa=n,t.push(e)),e};var Je="closure_lm_"+(1e6*Math.random()|0),Ze={};function tn(t,e,n,r,i){if(r&&r.once)return rn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)tn(t,e[o],n,r,i);return null}return n=ln(n),t&&t[Ge]?t.N(e,n,Yt(r)?!!r.capture:!!r,i):en(t,e,n,!1,r,i)}function en(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=Yt(i)?!!i.capture:!!i,a=cn(t);if(a||(t[Je]=a=new Ye(t)),n=a.add(e,n,r,s,o),n.proxy)return n;if(r=nn(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)je||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(an(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function nn(){function t(n){return e.call(t.src,t.listener,n)}var e=un;return t}function rn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)rn(t,e[o],n,r,i);return null}return n=ln(n),t&&t[Ge]?t.O(e,n,Yt(r)?!!r.capture:!!r,i):en(t,e,n,!0,r,i)}function on(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)on(t,e[o],n,r,i);else r=Yt(r)?!!r.capture:!!r,n=ln(n),t&&t[Ge]?(t=t.i,e=String(e).toString(),e in t.g&&(o=t.g[e],n=$e(o,n,r,i),-1<n&&(We(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=cn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=$e(e,n,r,i)),(n=-1<t?e[t]:null)&&sn(n))}function sn(t){if("number"!==typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Ge])Xe(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(an(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=cn(e))?(Xe(n,t),0==n.h&&(n.src=null,e[Je]=null)):We(t)}}}function an(t){return t in Ze?Ze[t]:Ze[t]="on"+t}function un(t,e){if(t.ca)t=!0;else{e=new Ke(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&sn(t),t=n.call(r,e)}return t}function cn(t){return t=t[Je],t instanceof Ye?t:null}var hn="__closure_events_fn_"+(1e9*Math.random()>>>0);function ln(t){return"function"===typeof t?t:(t[hn]||(t[hn]=function(e){return t.handleEvent(e)}),t[hn])}function fn(){ie.call(this),this.i=new Ye(this),this.P=this,this.I=null}function pn(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"===typeof e)e=new Be(e,t);else if(e instanceof Be)e.target=e.target||t;else{var i=e;e=new Be(r,t),Ie(e,i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=dn(s,r,!0,e)&&i}if(s=e.g=t,i=dn(s,r,!0,e)&&i,i=dn(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)s=e.g=n[o],i=dn(s,r,!1,e)&&i}function dn(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&Xe(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}re(fn,ie),fn.prototype[Ge]=!0,fn.prototype.removeEventListener=function(t,e,n,r){on(this,t,e,n,r)},fn.prototype.M=function(){if(fn.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)We(n[r]);delete e.g[t],e.h--}}this.I=null},fn.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},fn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var yn=Ht.JSON.stringify;function vn(){var t=Sn,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var gn,mn=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=bn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),bn=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new wn}),(function(t){return t.reset()})),wn=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function En(t){Ht.setTimeout((function(){throw t}),0)}function In(t,e){gn||_n(),Tn||(gn(),Tn=!0),Sn.add(t,e)}function _n(){var t=Ht.Promise.resolve(void 0);gn=function(){t.then(An)}}var Tn=!1,Sn=new mn;function An(){for(var t;t=vn();){try{t.h.call(t.g)}catch(n){En(n)}var e=bn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Tn=!1}function Nn(t,e){fn.call(this),this.h=t||1,this.g=e||Ht,this.j=ee(this.kb,this),this.l=Date.now()}function Dn(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Cn(t,e,n){if("function"===typeof t)n&&(t=ee(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ee(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ht.setTimeout(t,e||0)}function Rn(t){t.g=Cn((function(){t.g=null,t.i&&(t.i=!1,Rn(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}re(Nn,fn),Kt=Nn.prototype,Kt.da=!1,Kt.S=null,Kt.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),pn(this,"tick"),this.da&&(Dn(this),this.start()))}},Kt.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Kt.M=function(){Nn.Z.M.call(this),Dn(this),delete this.g};var kn=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return jt(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:Rn(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Ht.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(ie);function On(t){ie.call(this),this.h=t,this.g={}}re(On,ie);var xn=[];function Ln(t,e,n,r){Array.isArray(n)||(n&&(xn[0]=n.toString()),n=xn);for(var i=0;i<n.length;i++){var o=tn(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function Pn(t){be(t.g,(function(t,e){this.g.hasOwnProperty(e)&&sn(t)}),t),t.g={}}function Mn(){this.g=!0}function Fn(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}function Vn(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}function Un(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+jn(t,n)+(r?" "+r:"")}))}function qn(t,e){t.info((function(){return"TIMEOUT: "+e}))}function jn(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return yn(n)}catch(a){return e}}On.prototype.M=function(){On.Z.M.call(this),Pn(this)},On.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Mn.prototype.Aa=function(){this.g=!1},Mn.prototype.info=function(){};var Bn={},Kn=null;function zn(){return Kn=Kn||new fn}function Gn(t){Be.call(this,Bn.Ma,t)}function Hn(t){var e=zn();pn(e,new Gn(e,t))}function Qn(t,e){Be.call(this,Bn.STAT_EVENT,t),this.stat=e}function Wn(t){var e=zn();pn(e,new Qn(e,t))}function Yn(t,e){Be.call(this,Bn.Na,t),this.size=e}function Xn(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return Ht.setTimeout((function(){t()}),e)}Bn.Ma="serverreachability",re(Gn,Be),Bn.STAT_EVENT="statevent",re(Qn,Be),Bn.Na="timingevent",re(Yn,Be);var $n={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Jn={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Zn(){}function tr(t){return t.h||(t.h=t.i())}function er(){}Zn.prototype.h=null;var nr,rr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ir(){Be.call(this,"d")}function or(){Be.call(this,"c")}function sr(){}function ar(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new On(this),this.P=cr,t=Ce?125:void 0,this.W=new Nn(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ur}function ur(){this.i=null,this.g="",this.h=!1}re(ir,Be),re(or,Be),re(sr,Zn),sr.prototype.g=function(){return new XMLHttpRequest},sr.prototype.i=function(){return{}},nr=new sr;var cr=45e3,hr={},lr={};function fr(t,e,n){t.K=1,t.v=Fr(kr(e)),t.s=n,t.U=!0,pr(t,null)}function pr(t,e){t.F=Date.now(),gr(t),t.A=kr(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Jr(n.h,"t",r),t.C=0,n=t.l.H,t.h=new ur,t.g=io(t.l,n?e:null,!t.s),0<t.O&&(t.L=new kn(ee(t.Ia,t,t.g),t.O)),Ln(t.V,t.g,"readystatechange",t.gb),e=t.H?we(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Hn(1),Fn(t.j,t.u,t.A,t.m,t.X,t.s)}function dr(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function yr(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if(r=vr(t,n),r==lr){4==e&&(t.o=4,Wn(14),i=!1),Un(t.j,t.m,null,"[Incomplete Response]");break}if(r==hr){t.o=4,Wn(15),Un(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Un(t.j,t.m,r,null),Ir(t,r)}dr(t)&&r!=lr&&r!=hr&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Wn(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xi(e),e.L=!0,Wn(11))):(Un(t.j,t.m,n,"[Invalid Chunked Response]"),Er(t),wr(t))}function vr(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?lr:(n=Number(e.substring(n,r)),isNaN(n)?hr:(r+=1,r+n>e.length?lr:(e=e.substr(r,n),t.C=r+n,e)))}function gr(t){t.Y=Date.now()+t.P,mr(t,t.P)}function mr(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Xn(ee(t.eb,t),e)}function br(t){t.B&&(Ht.clearTimeout(t.B),t.B=null)}function wr(t){0==t.l.G||t.I||Zi(t.l,t)}function Er(t){br(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Dn(t.W),Pn(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Ir(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||si(n.i,t)))if(n.I=t.N,!t.J&&si(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Ji(n),qi(n)}Yi(n),Wn(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Xn(ee(n.ab,n),6e3));if(1>=oi(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else eo(n,11)}else if((t.J||n.g==t)&&Ji(n),!fe(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(ye(h,"spdy")||ye(h,"quic")||ye(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(ai(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,Mr(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var p=t;if(r.oa=ro(r,r.H?r.la:null,r.W),p.J){ui(r.i,p);var d=p,y=r.K;y&&d.setTimeout(y),d.B&&(br(d),gr(d)),r.g=p}else Wi(r);0<n.l.length&&Ki(n)}else"stop"!=o[0]&&"close"!=o[0]||eo(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?eo(n,7):Ui(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}Hn(4)}catch(o){}}function _r(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"===typeof t)return t.split("");if(Wt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Tr(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Wt(t)||"string"===typeof t)ue(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(Wt(t)||"string"===typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=_r(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Sr(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Sr)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ar(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Nr(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)r=t.g[e],Nr(i,r)||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Nr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}Kt=ar.prototype,Kt.setTimeout=function(t){this.P=t},Kt.gb=function(t){t=t.target;var e=this.L;e&&3==xi(t)?e.l():this.Ia(t)},Kt.Ia=function(t){try{if(t==this.g)t:{var e=xi(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||Ce||this.g&&(this.h.h||this.g.ga()||Li(this.g)))){this.I||4!=e||7==n||Hn(8==n||0>=r?3:2),br(this);var i=this.g.ba();this.N=i;e:if(dr(this)){var o=Li(this.g);t="";var s=o.length,a=4==xi(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Er(this),wr(this);var u="";break e}this.h.i=new Ht.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,Vn(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!fe(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,Wn(12),Er(this),wr(this);break t}Un(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Ir(this,i)}this.U?(yr(this,e,u),Ce&&this.i&&3==e&&(Ln(this.V,this.W,"tick",this.fb),this.W.start())):(Un(this.j,this.m,u,null),Ir(this,u)),4==e&&Er(this),this.i&&!this.I&&(4==e?Zi(this.l,this):(this.i=!1,gr(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Wn(12)):(this.o=0,Wn(13)),Er(this),wr(this)}}}catch(e){}},Kt.fb=function(){if(this.g){var t=xi(this.g),e=this.g.ga();this.C<e.length&&(br(this),yr(this,t,e),this.i&&4!=t&&gr(this))}},Kt.cancel=function(){this.I=!0,Er(this)},Kt.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(qn(this.j,this.A),2!=this.K&&(Hn(3),Wn(17)),Er(this),this.o=2,wr(this)):mr(this,this.Y-t)},Kt=Sr.prototype,Kt.R=function(){Ar(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},Kt.T=function(){return Ar(this),this.g.concat()},Kt.get=function(t,e){return Nr(this.h,t)?this.h[t]:e},Kt.set=function(t,e){Nr(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},Kt.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Dr=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Cr(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Rr(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Rr){this.g=void 0!==e?e:t.g,Or(this,t.j),this.s=t.s,xr(this,t.i),Lr(this,t.m),this.l=t.l,e=t.h;var n=new Wr;n.i=e.i,e.g&&(n.g=new Sr(e.g),n.h=e.h),Pr(this,n),this.o=t.o}else t&&(n=String(t).match(Dr))?(this.g=!!e,Or(this,n[1]||"",!0),this.s=qr(n[2]||""),xr(this,n[3]||"",!0),Lr(this,n[4]),this.l=qr(n[5]||"",!0),Pr(this,n[6]||"",!0),this.o=qr(n[7]||"")):(this.g=!!e,this.h=new Wr(null,this.g))}function kr(t){return new Rr(t)}function Or(t,e,n){t.j=n?qr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function xr(t,e,n){t.i=n?qr(e,!0):e}function Lr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Pr(t,e,n){e instanceof Wr?(t.h=e,ti(t.h,t.g)):(n||(e=jr(e,Hr)),t.h=new Wr(e,t.g))}function Mr(t,e,n){t.h.set(e,n)}function Fr(t){return Mr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Vr(t){return t instanceof Rr?kr(t):new Rr(t,void 0)}function Ur(t,e,n,r){var i=new Rr(null,void 0);return t&&Or(i,t),e&&xr(i,e),n&&Lr(i,n),r&&(i.l=r),i}function qr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function jr(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,Br),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Br(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}Rr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(jr(e,Kr,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(jr(e,Kr,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,null!=n&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(jr(n,"/"==n.charAt(0)?Gr:zr,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",jr(n,Qr)),t.join("")};var Kr=/[#\/\?@]/g,zr=/[#\?:]/g,Gr=/[#\?]/g,Hr=/[#\?@]/g,Qr=/#/g;function Wr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Yr(t){t.g||(t.g=new Sr,t.h=0,t.i&&Cr(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Xr(t,e){Yr(t),e=Zr(t,e),Nr(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,Nr(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Ar(t)))}function $r(t,e){return Yr(t),e=Zr(t,e),Nr(t.g.h,e)}function Jr(t,e,n){Xr(t,e),0<n.length&&(t.i=null,t.g.set(Zr(t,e),le(n)),t.h+=n.length)}function Zr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function ti(t,e){e&&!t.j&&(Yr(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Xr(this,e),Jr(this,n,t))}),t)),t.j=e}Kt=Wr.prototype,Kt.add=function(t,e){Yr(this),this.i=null,t=Zr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Kt.forEach=function(t,e){Yr(this),this.g.forEach((function(n,r){ue(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Kt.T=function(){Yr(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Kt.R=function(t){Yr(this);var e=[];if("string"===typeof t)$r(this,t)&&(e=he(e,this.g.get(Zr(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=he(e,t[n])}return e},Kt.set=function(t,e){return Yr(this),this.i=null,t=Zr(this,t),$r(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Kt.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e},Kt.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var ei=function(){function t(t,e){this.h=t,this.g=e}return t}();function ni(t){this.l=t||ri,Ht.PerformanceNavigationTiming?(t=Ht.performance.getEntriesByType("navigation"),t=0<t.length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol)):t=!!(Ht.g&&Ht.g.Ea&&Ht.g.Ea()&&Ht.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var ri=10;function ii(t){return!!t.h||!!t.g&&t.g.size>=t.j}function oi(t){return t.h?1:t.g?t.g.size:0}function si(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ai(t,e){t.g?t.g.add(e):t.h=e}function ui(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ci(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Bt(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(a){e={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return le(t.i)}function hi(){}function li(){this.g=new hi}function fi(t,e,n){var r=n||"";try{Tr(t,(function(t,n){var i=t;Yt(t)&&(i=yn(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function pi(t,e){var n=new Mn;if(Ht.Image){var r=new Image;r.onload=ne(di,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ne(di,n,r,"TestLoadImage: error",!1,e),r.onabort=ne(di,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ne(di,n,r,"TestLoadImage: timeout",!1,e),Ht.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}function di(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}function yi(t){this.l=t.$b||null,this.j=t.ib||!1}function vi(t,e){fn.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=gi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ni.prototype.cancel=function(){var t,e;if(this.i=ci(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Bt(this.g.values()),r=n.next();!r.done;r=n.next()){var i=r.value;i.cancel()}}catch(o){t={error:o}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},hi.prototype.stringify=function(t){return Ht.JSON.stringify(t,void 0)},hi.prototype.parse=function(t){return Ht.JSON.parse(t,void 0)},re(yi,Zn),yi.prototype.g=function(){return new vi(this.l,this.j)},yi.prototype.i=function(t){return function(){return t}}({}),re(vi,fn);var gi=0;function mi(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function bi(t){t.readyState=4,t.l=null,t.j=null,t.A=null,wi(t)}function wi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Kt=vi.prototype,Kt.open=function(t,e){if(this.readyState!=gi)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,wi(this)},Kt.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Ht).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Kt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,bi(this)),this.readyState=gi},Kt.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,wi(this)),this.g&&(this.readyState=3,wi(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if("undefined"!==typeof Ht.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;mi(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},Kt.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?bi(this):wi(this),3==this.readyState&&mi(this)}},Kt.Ua=function(t){this.g&&(this.response=this.responseText=t,bi(this))},Kt.Ta=function(t){this.g&&(this.response=t,bi(this))},Kt.ha=function(){this.g&&bi(this)},Kt.setRequestHeader=function(t,e){this.v.append(t,e)},Kt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Kt.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(vi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Ei=Ht.JSON.parse;function Ii(t){fn.call(this),this.headers=new Sr,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=_i,this.K=this.L=!1}re(Ii,fn);var _i="",Ti=/^https?$/i,Si=["POST","PUT"];function Ai(t){return Ne&&Ve()&&"number"===typeof t.timeout&&void 0!==t.ontimeout}function Ni(t){return"content-type"==t.toLowerCase()}function Di(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ci(t),ki(t)}function Ci(t){t.D||(t.D=!0,pn(t,"complete"),pn(t,"error"))}function Ri(t){if(t.h&&"undefined"!=typeof Gt&&(!t.C[1]||4!=xi(t)||2!=t.ba()))if(t.v&&4==xi(t))Cn(t.Fa,0,t);else if(pn(t,"readystatechange"),4==xi(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(Dr)[1]||null;if(!o&&Ht.self&&Ht.self.location){var s=Ht.self.location.protocol;o=s.substr(0,s.length-1)}i=!Ti.test(o?o.toLowerCase():"")}e=i}if(e)pn(t,"complete"),pn(t,"success");else{t.m=6;try{var a=2<xi(t)?t.g.statusText:""}catch(u){a=""}t.j=a+" ["+t.ba()+"]",Ci(t)}}finally{ki(t)}}}function ki(t,e){if(t.g){Oi(t);var n=t.g,r=t.C[0]?Qt:null;t.g=null,t.C=null,e||pn(t,"ready");try{n.onreadystatechange=r}catch(i){}}}function Oi(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Ht.clearTimeout(t.A),t.A=null)}function xi(t){return t.g?t.g.readyState:0}function Li(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case _i:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Pi(t){var e="";return be(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Mi(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Pi(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):Mr(t,e,n))}function Fi(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Vi(t){this.za=0,this.l=[],this.h=new Mn,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Fi("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Fi("baseRetryDelayMs",5e3,t),this.$a=Fi("retryDelaySeedMs",1e4,t),this.Ya=Fi("forwardChannelMaxRetries",2,t),this.ra=Fi("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new ni(t&&t.concurrentRequestLimit),this.Ca=new li,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Ui(t){if(ji(t),3==t.G){var e=t.V++,n=kr(t.F);Mr(n,"SID",t.J),Mr(n,"RID",e),Mr(n,"TYPE","terminate"),Hi(t,n),e=new ar(t,t.h,e,void 0),e.K=2,e.v=Fr(kr(n)),n=!1,Ht.navigator&&Ht.navigator.sendBeacon&&(n=Ht.navigator.sendBeacon(e.v.toString(),"")),!n&&Ht.Image&&((new Image).src=e.v,n=!0),n||(e.g=io(e.l,null),e.g.ea(e.v)),e.F=Date.now(),gr(e)}no(t)}function qi(t){t.g&&(Xi(t),t.g.cancel(),t.g=null)}function ji(t){qi(t),t.u&&(Ht.clearTimeout(t.u),t.u=null),Ji(t),t.i.cancel(),t.m&&("number"===typeof t.m&&Ht.clearTimeout(t.m),t.m=null)}function Bi(t,e){t.l.push(new ei(t.Za++,e)),3==t.G&&Ki(t)}function Ki(t){ii(t.i)||t.m||(t.m=!0,In(t.Ha,t),t.C=0)}function zi(t,e){return!(oi(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.l=e.D.concat(t.l),!0):!(1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya))&&(t.m=Xn(ee(t.Ha,t,e),to(t,t.C)),t.C++,!0))}function Gi(t,e){var n;n=e?e.m:t.V++;var r=kr(t.F);Mr(r,"SID",t.J),Mr(r,"RID",n),Mr(r,"AID",t.U),Hi(t,r),t.o&&t.s&&Mi(r,t.o,t.s),n=new ar(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Qi(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),ai(t.i,n),fr(n,r,e)}function Hi(t,e){t.j&&Tr({},(function(t,n){Mr(e,n,t)}))}function Qi(t,e,n){n=Math.min(t.l.length,n);var r=t.j?ee(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(c-=o,0>c)o=Math.max(0,i[u].h-100),a=!1;else try{fi(h,s,"req"+c+"_")}catch(qo){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function Wi(t){t.g||t.u||(t.Y=1,In(t.Ga,t),t.A=0)}function Yi(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Xn(ee(t.Ga,t),to(t,t.A)),t.A++,!0)}function Xi(t){null!=t.B&&(Ht.clearTimeout(t.B),t.B=null)}function $i(t){t.g=new ar(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=kr(t.oa);Mr(e,"RID","rpc"),Mr(e,"SID",t.J),Mr(e,"CI",t.N?"0":"1"),Mr(e,"AID",t.U),Hi(t,e),Mr(e,"TYPE","xmlhttp"),t.o&&t.s&&Mi(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Fr(kr(e)),n.s=null,n.U=!0,pr(n,t)}function Ji(t){null!=t.v&&(Ht.clearTimeout(t.v),t.v=null)}function Zi(t,e){var n=null;if(t.g==e){Ji(t),Xi(t),t.g=null;var r=2}else{if(!si(t.i,e))return;n=e.D,ui(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;r=zn(),pn(r,new Yn(r,n,e,i)),Ki(t)}else Wi(t);else if(i=e.o,3==i||0==i&&0<t.I||!(1==r&&zi(t,e)||2==r&&Yi(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:eo(t,5);break;case 4:eo(t,10);break;case 3:eo(t,6);break;default:eo(t,2)}}function to(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function eo(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=ee(t.jb,t);n||(n=new Rr("//www.google.com/images/cleardot.gif"),Ht.location&&"http"==Ht.location.protocol||Or(n,"https"),Fr(n)),pi(n.toString(),r)}else Wn(2);t.G=0,t.j&&t.j.va(e),no(t),ji(t)}function no(t){t.G=0,t.I=-1,t.j&&(0==ci(t.i).length&&0==t.l.length||(t.i.i.length=0,le(t.l),t.l.length=0),t.j.ua())}function ro(t,e,n){var r=Vr(n);if(""!=r.i)e&&xr(r,e+"."+r.i),Lr(r,r.m);else{var i=Ht.location;r=Ur(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&be(t.aa,(function(t,e){Mr(r,e,t)})),e=t.D,n=t.sa,e&&n&&Mr(r,e,n),Mr(r,"VER",t.ma),Hi(t,r),r}function io(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new Ii(new yi({ib:!0})):new Ii(t.qa),e.L=t.H,e}function oo(){}function so(){if(Ne&&!(10<=Number(qe)))throw Error("Environmental error: no available transport.")}function ao(t,e){fn.call(this),this.g=new Vi(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!fe(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!fe(e)&&(this.g.D=e,t=this.h,null!==t&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new ho(this)}function uo(t){ir.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function co(){or.call(this),this.status=1}function ho(t){this.g=t}Kt=Ii.prototype,Kt.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():nr.g(),this.C=this.u?tr(this.u):tr(nr),this.g.onreadystatechange=ee(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){return void Di(this,o)}t=n||"";var i=new Sr(this.headers);r&&Tr(r,(function(t,e){i.set(e,t)})),r=ce(i.T()),n=Ht.FormData&&t instanceof Ht.FormData,!(0<=ae(Si,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Oi(this),0<this.B&&((this.K=Ai(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ee(this.pa,this)):this.A=Cn(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){Di(this,o)}},Kt.pa=function(){"undefined"!=typeof Gt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,pn(this,"timeout"),this.abort(8))},Kt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,pn(this,"complete"),pn(this,"abort"),ki(this))},Kt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ki(this,!0)),Ii.Z.M.call(this)},Kt.Fa=function(){this.s||(this.F||this.v||this.l?Ri(this):this.cb())},Kt.cb=function(){Ri(this)},Kt.ba=function(){try{return 2<xi(this)?this.g.status:-1}catch(t){return-1}},Kt.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Kt.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ei(e)}},Kt.Da=function(){return this.m},Kt.La=function(){return"string"===typeof this.j?this.j:String(this.j)},Kt=Vi.prototype,Kt.ma=8,Kt.G=1,Kt.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},Kt.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new ar(this,this.h,t,void 0),n=this.s;if(this.P&&(n?(n=we(n),Ie(n,this.P)):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(o="__data__"in o.g&&(o=o.g.__data__,"string"===typeof o)?o.length:void 0,void 0===o)break;if(r+=o,4096<r){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Qi(this,e,r),i=kr(this.F),Mr(i,"RID",t),Mr(i,"CVER",22),this.D&&Mr(i,"X-HTTP-Session-Id",this.D),Hi(this,i),this.o&&n&&Mi(i,this.o,n),ai(this.i,e),this.Ra&&Mr(i,"TYPE","init"),this.ja?(Mr(i,"$req",r),Mr(i,"SID","null"),e.$=!0,fr(e,i,null)):fr(e,i,r),this.G=2}}else 3==this.G&&(t?Gi(this,t):0==this.l.length||ii(this.i)||Gi(this))},Kt.Ga=function(){if(this.u=null,$i(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Xn(ee(this.bb,this),t)}},Kt.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Wn(10),qi(this),$i(this))},Kt.ab=function(){null!=this.v&&(this.v=null,qi(this),Yi(this),Wn(19))},Kt.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Wn(2)):(this.h.info("Failed to ping google.com"),Wn(1))},Kt=oo.prototype,Kt.xa=function(){},Kt.wa=function(){},Kt.va=function(){},Kt.ua=function(){},Kt.Oa=function(){},so.prototype.g=function(t,e){return new ao(t,e)},re(ao,fn),ao.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),In(ee(t.hb,t,e))),Wn(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=ro(t,null,t.W),Ki(t)},ao.prototype.close=function(){Ui(this.g)},ao.prototype.u=function(t){if("string"===typeof t){var e={};e.__data__=t,Bi(this.g,e)}else this.v?(e={},e.__data__=yn(t),Bi(this.g,e)):Bi(this.g,t)},ao.prototype.M=function(){this.g.j=null,delete this.j,Ui(this.g),delete this.g,ao.Z.M.call(this)},re(uo,ir),re(co,or),re(ho,oo),ho.prototype.xa=function(){pn(this.g,"a")},ho.prototype.wa=function(t){pn(this.g,new uo(t))},ho.prototype.va=function(t){pn(this.g,new co(t))},ho.prototype.ua=function(){pn(this.g,"b")},so.prototype.createWebChannel=so.prototype.g,ao.prototype.send=ao.prototype.u,ao.prototype.open=ao.prototype.m,ao.prototype.close=ao.prototype.close,$n.NO_ERROR=0,$n.TIMEOUT=8,$n.HTTP_ERROR=6,Jn.COMPLETE="complete",er.EventType=rr,rr.OPEN="a",rr.CLOSE="b",rr.ERROR="c",rr.MESSAGE="d",fn.prototype.listen=fn.prototype.N,Ii.prototype.listenOnce=Ii.prototype.O,Ii.prototype.getLastError=Ii.prototype.La,Ii.prototype.getLastErrorCode=Ii.prototype.Da,Ii.prototype.getStatus=Ii.prototype.ba,Ii.prototype.getResponseJson=Ii.prototype.Qa,Ii.prototype.getResponseText=Ii.prototype.ga,Ii.prototype.send=Ii.prototype.ea;var lo=function(){return new so},fo=function(){return zn()},po=$n,yo=Jn,vo=Bn,go={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},mo=yi,bo=er,wo=Ii,Eo=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Eo.o=-1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Io={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},_o=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return i(e,t),e}(Error),To=new rt("@firebase/firestore");function So(){return To.logLevel}function Ao(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(To.logLevel<=X.DEBUG){var r=e.map(Co);To.debug.apply(To,h(["Firestore (8.10.1): "+t],r))}}function No(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(To.logLevel<=X.ERROR){var r=e.map(Co);To.error.apply(To,h(["Firestore (8.10.1): "+t],r))}}function Do(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(To.logLevel<=X.WARN){var r=e.map(Co);To.warn.apply(To,h(["Firestore (8.10.1): "+t],r))}}function Co(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.10.1) INTERNAL ASSERTION FAILED: "+t;throw No(e),new Error(e)}function ko(t,e){t||Ro()}function Oo(t,e){return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xo(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lo=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=xo(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Po(t,e){return t<e?-1:t>e?1:0}function Mo(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Fo(t){return t+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vo=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new _o(Io.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new _o(Io.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new _o(Io.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new _o(Io.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Po(this.nanoseconds,t.nanoseconds):Po(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Uo=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Vo(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function jo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Bo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ko=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Ro(),void 0===n?n=t.length-e:n>t.length-e&&Ro(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),zo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new _o(Io.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Ko),Go=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ho=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Go.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new _o(Io.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new _o(Io.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new _o(Io.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new _o(Io.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Ko),Qo=function(){function t(t){this.fields=t,t.sort(Ho.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Mo(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Wo=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Po(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Wo.EMPTY_BYTE_STRING=new Wo("");var Yo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xo(t){if(ko(!!t),"string"==typeof t){var e=0,n=Yo.exec(t);if(ko(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:$o(t.seconds),nanos:$o(t.nanos)}}function $o(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Jo(t){return"string"==typeof t?Wo.fromBase64String(t):Wo.fromUint8Array(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ts(t){var e=t.mapValue.fields.__previous_value__;return Zo(e)?ts(e):e}function es(t){var e=Xo(t.mapValue.fields.__local_write_time__.timestampValue);return new Vo(e.seconds,e.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(t){return null==t}function rs(t){return 0===t&&1/t==-1/0}function is(t){return"number"==typeof t&&Number.isInteger(t)&&!rs(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var os=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(zo.fromString(e))},t.fromName=function(e){return new t(zo.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===zo.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return zo.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new zo(e.slice()))},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zo(t)?4:10:Ro()}function as(t,e){var n=ss(t);if(n!==ss(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return es(t).isEqual(es(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Xo(t.timestampValue),r=Xo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Jo(t.bytesValue).isEqual(Jo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return $o(t.geoPointValue.latitude)===$o(e.geoPointValue.latitude)&&$o(t.geoPointValue.longitude)===$o(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return $o(t.integerValue)===$o(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=$o(t.doubleValue),r=$o(e.doubleValue);return n===r?rs(n)===rs(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Mo(t.arrayValue.values||[],e.arrayValue.values||[],as);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(qo(n)!==qo(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!as(n[i],r[i])))return!1;return!0}(t,e);default:return Ro()}}function us(t,e){return void 0!==(t.values||[]).find((function(t){return as(t,e)}))}function cs(t,e){var n=ss(t),r=ss(e);if(n!==r)return Po(n,r);switch(n){case 0:return 0;case 1:return Po(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=$o(t.integerValue||t.doubleValue),r=$o(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return hs(t.timestampValue,e.timestampValue);case 4:return hs(es(t),es(e));case 5:return Po(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Jo(t),r=Jo(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Po(n[i],r[i]);if(0!==o)return o}return Po(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Po($o(t.latitude),$o(e.latitude));return 0!==n?n:Po($o(t.longitude),$o(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=cs(n[i],r[i]);if(o)return o}return Po(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Po(r[s],o[s]);if(0!==a)return a;var u=cs(n[r[s]],i[o[s]]);if(0!==u)return u}return Po(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ro()}}function hs(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Po(t,e);var n=Xo(t),r=Xo(e),i=Po(n.seconds,r.seconds);return 0!==i?i:Po(n.nanos,r.nanos)}function ls(t){return fs(t)}function fs(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Xo(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Jo(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,os.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=fs(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+fs(t.fields[o])}return e+"}"}(t.mapValue):Ro();var e,n}function ps(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function ds(t){return!!t&&"integerValue"in t}function ys(t){return!!t&&"arrayValue"in t}function vs(t){return!!t&&"nullValue"in t}function gs(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ms(t){return!!t&&"mapValue"in t}function bs(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return jo(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=bs(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=bs(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ws=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!ms(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=bs(e)},t.prototype.setAll=function(t){var e=this,n=Ho.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=bs(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());ms(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return as(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];ms(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){jo(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(bs(this.value))},t}();function Es(t){var e=[];return jo(t.fields,(function(t,n){var r=new Ho([t]);if(ms(n)){var i=Es(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new Qo(e)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var Is=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,Uo.min(),ws.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,ws.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,ws.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=ws.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=ws.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),_s=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new _s(t,e,n,r,i,o,s)}function Ss(t){var e=Oo(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+ls(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),ns(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Vs(e.startAt)),e.endAt&&(n+="|ub:",n+=Vs(e.endAt)),e.h=n}return e.h}function As(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!qs(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!as(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bs(t.startAt,e.startAt)&&Bs(t.endAt,e.endAt)}function Ns(t){return os.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ds=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return i(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Cs(t,n,r):"array-contains"===n?new xs(t,r):"in"===n?new Ls(t,r):"not-in"===n?new Ps(t,r):"array-contains-any"===n?new Ms(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Rs(t,n):new ks(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(cs(e,this.value)):null!==e&&ss(this.value)===ss(e)&&this.m(cs(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ro()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Cs=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=os.fromName(r.referenceValue),i}return i(e,t),e.prototype.matches=function(t){var e=os.comparator(t.key,this.key);return this.m(e)},e}(Ds),Rs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Os("in",n),r}return i(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ds),ks=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Os("not-in",n),r}return i(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ds);function Os(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return os.fromName(t.referenceValue)}))}var xs=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return i(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return ys(e)&&us(e.arrayValue,this.value)},e}(Ds),Ls=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return i(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&us(this.value.arrayValue,e)},e}(Ds),Ps=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return i(e,t),e.prototype.matches=function(t){if(us(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!us(this.value.arrayValue,e)},e}(Ds),Ms=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return i(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!ys(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return us(e.value.arrayValue,t)}))},e}(Ds),Fs=function(t,e){this.position=t,this.before=e};function Vs(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return ls(t)})).join(",")}var Us=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function qs(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function js(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?os.comparator(os.fromName(s.referenceValue),n.key):cs(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Bs(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!as(t.position[n],e.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ks=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function zs(t,e,n,r,i,o,s,a){return new Ks(t,e,n,r,i,o,s,a)}function Gs(t){return new Ks(t)}function Hs(t){return!ns(t.limit)&&"F"===t.limitType}function Qs(t){return!ns(t.limit)&&"L"===t.limitType}function Ws(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Ys(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Xs(t){return null!==t.collectionGroup}function $s(t){var e=Oo(t);if(null===e.p){e.p=[];var n=Ys(e),r=Ws(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Us(n)),e.p.push(new Us(Ho.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Us(Ho.keyField(),u))}}}return e.p}function Js(t){var e=Oo(t);if(!e.T)if("F"===e.limitType)e.T=Ts(e.path,e.collectionGroup,$s(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=$s(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Us(o.field,s))}var a=e.endAt?new Fs(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Fs(e.startAt.position,!e.startAt.before):null;e.T=Ts(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Zs(t,e,n){return new Ks(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ta(t,e){return As(Js(t),Js(e))&&t.limitType===e.limitType}function ea(t){return Ss(Js(t))+"|lt:"+t.limitType}function na(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+ls(e.value);var e})).join(", ")+"]"),ns(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Vs(t.startAt)),t.endAt&&(e+=", endAt: "+Vs(t.endAt)),"Target("+e+")"}(Js(t))+"; limitType="+t.limitType+")"}function ra(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):os.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!js(t.startAt,$s(t),e))&&(!t.endAt||!js(t.endAt,$s(t),e))}(t,e)}function ia(t){return function(e,n){for(var r=!1,i=0,o=$s(t);i<o.length;i++){var s=o[i],a=oa(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function oa(t,e,n){var r=t.field.isKeyField()?os.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?cs(r,i):Ro()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ro()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:rs(e)?"-0":e}}function aa(t){return{integerValue:""+t}}function ua(t,e){return is(e)?aa(e):sa(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ca=function(){this._=void 0};function ha(t,e,n){return t instanceof pa?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof da?ya(t,e):t instanceof va?ga(t,e):function(t,e){var n=fa(t,e),r=ba(n)+ba(t.A);return ds(n)&&ds(t.A)?aa(r):sa(t.R,r)}(t,e)}function la(t,e,n){return t instanceof da?ya(t,e):t instanceof va?ga(t,e):n}function fa(t,e){return t instanceof ma?ds(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var pa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(ca),da=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return i(e,t),e}(ca);function ya(t,e){for(var n=wa(e),r=function(t){n.some((function(e){return as(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var va=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return i(e,t),e}(ca);function ga(t,e){for(var n=wa(e),r=function(t){n=n.filter((function(e){return!as(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ma=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return i(e,t),e}(ca);function ba(t){return $o(t.integerValue||t.doubleValue)}function wa(t){return ys(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ea=function(t,e){this.field=t,this.transform=e},Ia=function(t,e){this.version=t,this.transformResults=e},_a=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Ta(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Sa=function(){};function Aa(t,e,n){t instanceof ka?function(t,e,n){var r=t.value.clone(),i=La(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Oa?function(t,e,n){if(Ta(t.precondition,e)){var r=La(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(xa(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Na(t,e,n){t instanceof ka?function(t,e,n){if(Ta(t.precondition,e)){var r=t.value.clone(),i=Pa(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Ra(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Oa?function(t,e,n){if(Ta(t.precondition,e)){var r=Pa(t.fieldTransforms,n,e),i=e.data;i.setAll(xa(t)),i.setAll(r),e.convertToFoundDocument(Ra(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Ta(t.precondition,e)&&e.convertToNoDocument(Uo.min())}(t,e)}function Da(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=fa(o.transform,s||null);null!=a&&(null==n&&(n=ws.empty()),n.set(o.field,a))}return n||null}function Ca(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Mo(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof da&&e instanceof da||t instanceof va&&e instanceof va?Mo(t.elements,e.elements,as):t instanceof ma&&e instanceof ma?as(t.A,e.A):t instanceof pa&&e instanceof pa}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Ra(t){return t.isFoundDocument()?t.version:Uo.min()}var ka=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return i(e,t),e}(Sa),Oa=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return i(e,t),e}(Sa);function xa(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function La(t,e,n){var r=new Map;ko(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,la(s,a,n[i]))}return r}function Pa(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,ha(a,u,e))}return r}var Ma,Fa,Va=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return i(e,t),e}(Sa),Ua=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return i(e,t),e}(Sa),qa=function(t){this.count=t};function ja(t){switch(t){case Io.OK:return Ro();case Io.CANCELLED:case Io.UNKNOWN:case Io.DEADLINE_EXCEEDED:case Io.RESOURCE_EXHAUSTED:case Io.INTERNAL:case Io.UNAVAILABLE:case Io.UNAUTHENTICATED:return!1;case Io.INVALID_ARGUMENT:case Io.NOT_FOUND:case Io.ALREADY_EXISTS:case Io.PERMISSION_DENIED:case Io.FAILED_PRECONDITION:case Io.ABORTED:case Io.OUT_OF_RANGE:case Io.UNIMPLEMENTED:case Io.DATA_LOSS:return!0;default:return Ro()}}function Ba(t){if(void 0===t)return No("GRPC error has no .code"),Io.UNKNOWN;switch(t){case Ma.OK:return Io.OK;case Ma.CANCELLED:return Io.CANCELLED;case Ma.UNKNOWN:return Io.UNKNOWN;case Ma.DEADLINE_EXCEEDED:return Io.DEADLINE_EXCEEDED;case Ma.RESOURCE_EXHAUSTED:return Io.RESOURCE_EXHAUSTED;case Ma.INTERNAL:return Io.INTERNAL;case Ma.UNAVAILABLE:return Io.UNAVAILABLE;case Ma.UNAUTHENTICATED:return Io.UNAUTHENTICATED;case Ma.INVALID_ARGUMENT:return Io.INVALID_ARGUMENT;case Ma.NOT_FOUND:return Io.NOT_FOUND;case Ma.ALREADY_EXISTS:return Io.ALREADY_EXISTS;case Ma.PERMISSION_DENIED:return Io.PERMISSION_DENIED;case Ma.FAILED_PRECONDITION:return Io.FAILED_PRECONDITION;case Ma.ABORTED:return Io.ABORTED;case Ma.OUT_OF_RANGE:return Io.OUT_OF_RANGE;case Ma.UNIMPLEMENTED:return Io.UNIMPLEMENTED;case Ma.DATA_LOSS:return Io.DATA_LOSS;default:return Ro()}}(Fa=Ma||(Ma={}))[Fa.OK=0]="OK",Fa[Fa.CANCELLED=1]="CANCELLED",Fa[Fa.UNKNOWN=2]="UNKNOWN",Fa[Fa.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Fa[Fa.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Fa[Fa.NOT_FOUND=5]="NOT_FOUND",Fa[Fa.ALREADY_EXISTS=6]="ALREADY_EXISTS",Fa[Fa.PERMISSION_DENIED=7]="PERMISSION_DENIED",Fa[Fa.UNAUTHENTICATED=16]="UNAUTHENTICATED",Fa[Fa.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Fa[Fa.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Fa[Fa.ABORTED=10]="ABORTED",Fa[Fa.OUT_OF_RANGE=11]="OUT_OF_RANGE",Fa[Fa.UNIMPLEMENTED=12]="UNIMPLEMENTED",Fa[Fa.INTERNAL=13]="INTERNAL",Fa[Fa.UNAVAILABLE=14]="UNAVAILABLE",Fa[Fa.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ka=function(){function t(t,e){this.comparator=t,this.root=e||Ga.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ga.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ga.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new za(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new za(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new za(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new za(this.root,t,this.comparator,!0)},t}(),za=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Ga=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Ro();if(this.right.isRed())throw Ro();var t=this.left.check();if(t!==this.right.check())throw Ro();return t+(this.isRed()?0:1)},t}();Ga.EMPTY=null,Ga.RED=!0,Ga.BLACK=!1,Ga.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Ro()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Ro()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Ro()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Ro()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Ro()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Ga(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ha=function(){function t(t){this.comparator=t,this.data=new Ka(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Qa(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Qa(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Qa=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Wa=new Ka(os.comparator);function Ya(){return Wa}var Xa=new Ka(os.comparator);function $a(){return Xa}var Ja=new Ka(os.comparator);function Za(){return Ja}var tu=new Ha(os.comparator);function eu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=tu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var nu=new Ha(Po);function ru(){return nu}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var iu=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,ou.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Uo.min(),r,ru(),Ya(),eu())},t}(),ou=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Wo.EMPTY_BYTE_STRING,n,eu(),eu(),eu())},t}(),su=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},au=function(t,e){this.targetId=t,this.V=e},uu=function(t,e,n,r){void 0===n&&(n=Wo.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},cu=function(){function t(){this.S=0,this.D=fu(),this.C=Wo.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.k=!0,this.C=t)},t.prototype.M=function(){var t=eu(),e=eu(),n=eu();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Ro()}})),new ou(this.C,this.N,t,e,n)},t.prototype.L=function(){this.k=!1,this.D=fu()},t.prototype.B=function(t,e){this.k=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.k=!0,this.N=!0},t}(),hu=function(){function t(t){this.W=t,this.G=new Map,this.H=Ya(),this.J=lu(),this.Y=new Ha(Po)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.F||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.F||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Ro()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Ns(i))if(0===n){var o=new os(i.path);this.tt(e,o,Is.newNoDocument(o,Uo.min()))}else ko(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Ns(o.target)){var s=new os(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Is.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=eu();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new iu(t,n,this.Y,this.H,r);return this.H=Ya(),this.J=lu(),this.Y=new Ha(Po),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new cu,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Ha(Po),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Ao("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.F?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new cu),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function lu(){return new Ka(os.comparator)}function fu(){return new Ka(os.comparator)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pu={asc:"ASCENDING",desc:"DESCENDING"},du={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},yu=function(t,e){this.databaseId=t,this.I=e};function vu(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function gu(t,e){return t.I?e.toBase64():e.toUint8Array()}function mu(t,e){return vu(t,e.toTimestamp())}function bu(t){return ko(!!t),Uo.fromTimestamp(function(t){var e=Xo(t);return new Vo(e.seconds,e.nanos)}(t))}function wu(t,e){return function(t){return new zo(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Eu(t){var e=zo.fromString(t);return ko(Gu(e)),e}function Iu(t,e){return wu(t.databaseId,e.path)}function _u(t,e){var n=Eu(e);if(n.get(1)!==t.databaseId.projectId)throw new _o(Io.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new _o(Io.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new os(Nu(n))}function Tu(t,e){return wu(t.databaseId,e)}function Su(t){var e=Eu(t);return 4===e.length?zo.emptyPath():Nu(e)}function Au(t){return new zo(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Nu(t){return ko(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Du(t,e,n){return{name:Iu(t,e),fields:n.value.mapValue.fields}}function Cu(t,e,n){var r=_u(t,e.name),i=bu(e.updateTime),o=new ws({mapValue:{fields:e.fields}}),s=Is.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function Ru(t,e){var n;if(e instanceof ka)n={update:Du(t,e.key,e.value)};else if(e instanceof Va)n={delete:Iu(t,e.key)};else if(e instanceof Oa)n={update:Du(t,e.key,e.data),updateMask:zu(e.fieldMask)};else{if(!(e instanceof Ua))return Ro();n={verify:Iu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof pa)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof da)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof va)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof ma)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Ro()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:mu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ro()}(t,e.precondition)),n}function ku(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?_a.updateTime(bu(t.updateTime)):void 0!==t.exists?_a.exists(t.exists):_a.none()}(e.currentDocument):_a.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)ko("REQUEST_TIME"===e.setToServerValue),n=new pa;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new da(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new va(i)}else"increment"in e?n=new ma(t,e.increment):Ro();var o=Ho.fromServerFormat(e.fieldPath);return new Ea(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=_u(t,e.update.name),o=new ws({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Qo(e.map((function(t){return Ho.fromServerFormat(t)})))}(e.updateMask);return new Oa(i,o,s,n,r)}return new ka(i,o,n,r)}if(e.delete){var a=_u(t,e.delete);return new Va(a,n)}if(e.verify){var u=_u(t,e.verify);return new Ua(u,n)}return Ro()}function Ou(t,e){return{documents:[Tu(t,e.path)]}}function xu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Tu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Tu(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(gs(t.value))return{unaryFilter:{field:qu(t.field),op:"IS_NAN"}};if(vs(t.value))return{unaryFilter:{field:qu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(gs(t.value))return{unaryFilter:{field:qu(t.field),op:"IS_NOT_NAN"}};if(vs(t.value))return{unaryFilter:{field:qu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qu(t.field),op:Uu(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:qu(t.field),direction:Vu(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||ns(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Mu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Mu(e.endAt)),n}function Lu(t){var e=Su(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ko(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Pu(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new Us(ju(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return ns(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Fu(n.startAt));var h=null;return n.endAt&&(h=Fu(n.endAt)),zs(e,i,a,s,u,"F",c,h)}function Pu(t){return t?void 0!==t.unaryFilter?[Ku(t)]:void 0!==t.fieldFilter?[Bu(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Pu(t)})).reduce((function(t,e){return t.concat(e)})):Ro():[]}function Mu(t){return{before:t.before,values:t.position}}function Fu(t){var e=!!t.before,n=t.values||[];return new Fs(n,e)}function Vu(t){return pu[t]}function Uu(t){return du[t]}function qu(t){return{fieldPath:t.canonicalString()}}function ju(t){return Ho.fromServerFormat(t.fieldPath)}function Bu(t){return Ds.create(ju(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ro()}}(t.fieldFilter.op),t.fieldFilter.value)}function Ku(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ju(t.unaryFilter.field);return Ds.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ju(t.unaryFilter.field);return Ds.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ju(t.unaryFilter.field);return Ds.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ju(t.unaryFilter.field);return Ds.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ro()}}function zu(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function Gu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Wu(e)),e=Qu(t.get(n),e);return Wu(e)}function Qu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Wu(t){return t+""}function Yu(t){var e=t.length;if(ko(e>=2),2===e)return ko(""===t.charAt(0)&&""===t.charAt(1)),zo.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Ro(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Ro()}o=s+2}return new zo(r)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xu=function(t,e){this.seconds=t,this.nanoseconds=e},$u=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};$u.store="owner",$u.key="owner";var Ju=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ju.store="mutationQueues",Ju.keyPath="userId";var Zu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Zu.store="mutations",Zu.keyPath="batchId",Zu.userMutationsIndex="userMutationsIndex",Zu.userMutationsKeyPath=["userId","batchId"];var tc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Hu(e)]},t.key=function(t,e,n){return[t,Hu(e),n]},t}();tc.store="documentMutations",tc.PLACEHOLDER=new tc;var ec=function(t,e){this.path=t,this.readTime=e},nc=function(t,e){this.path=t,this.version=e},rc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};rc.store="remoteDocuments",rc.readTimeIndex="readTimeIndex",rc.readTimeIndexPath="readTime",rc.collectionReadTimeIndex="collectionReadTimeIndex",rc.collectionReadTimeIndexPath=["parentPath","readTime"];var ic=function(t){this.byteSize=t};ic.store="remoteDocumentGlobal",ic.key="remoteDocumentGlobalKey";var oc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};oc.store="targets",oc.keyPath="targetId",oc.queryTargetsIndexName="queryTargetsIndex",oc.queryTargetsKeyPath=["canonicalId","targetId"];var sc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};sc.store="targetDocuments",sc.keyPath=["targetId","path"],sc.documentTargetsIndex="documentTargetsIndex",sc.documentTargetsKeyPath=["path","targetId"];var ac=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ac.key="targetGlobalKey",ac.store="targetGlobal";var uc=function(t,e){this.collectionId=t,this.parent=e};uc.store="collectionParents",uc.keyPath=["collectionId","parent"];var cc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};cc.store="clientMetadata",cc.keyPath="clientId";var hc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};hc.store="bundles",hc.keyPath="bundleId";var lc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};lc.store="namedQueries",lc.keyPath="name";var fc=h(h([],h(h([],h(h([],h(h([],[Ju.store,Zu.store,tc.store,rc.store,oc.store,$u.store,ac.store,sc.store]),[cc.store])),[ic.store])),[uc.store])),[hc.store,lc.store]),pc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",dc=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),yc=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},vc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Ro(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),gc=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new yc,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new wc(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Sc(e.target.error);n.ft.reject(new wc(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new wc(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Ao("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ic(e)},t}(),mc=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(E())&&No("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Ao("SimpleDb","Removing database:",t),_c(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=E(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t={NODE_ENV:"production",BASE_URL:"/"})||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return s(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Ao("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new wc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new _o(Io.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new wc(t,n))},i.onupgradeneeded=function(t){Ao("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){Ao("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return s(this,void 0,void 0,(function(){var i,o,s,u,c;return a(this,(function(h){switch(h.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,c,h,l;return a(this,(function(a){switch(a.label){case 0:++o,a.label=1;case 1:return a.trys.push([1,4,,5]),[4,u.At(t)];case 2:return u.db=a.sent(),e=gc.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),vc.reject(t)})).toPromise(),c={},s.catch((function(){})),[4,e.dt];case 3:return[2,(c.value=(a.sent(),s),c)];case 4:return h=a.sent(),l="FirebaseError"!==h.name&&o<3,Ao("SimpleDb","Transaction failed with error:",h.message,"Retrying:",l),u.close(),l?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},u=this,h.label=1;case 1:return[5,s()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),bc=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return _c(this.Pt.delete())},t}(),wc=function(t){function e(e,n){var r=this;return(r=t.call(this,Io.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return i(e,t),e}(_o);function Ec(t){return"IndexedDbTransactionError"===t.name}var Ic=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Ao("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Ao("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),_c(n)},t.prototype.add=function(t){return Ao("SimpleDb","ADD",this.store.name,t,t),_c(this.store.add(t))},t.prototype.get=function(t){var e=this;return _c(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Ao("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Ao("SimpleDb","DELETE",this.store.name,t),_c(this.store.delete(t))},t.prototype.count=function(){return Ao("SimpleDb","COUNT",this.store.name),_c(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.kt=function(t,e){Ao("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Ft=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new vc((function(n,r){e.onerror=function(t){var e=Sc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new vc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new bc(i),s=e(i.primaryKey,i.value,o);if(s instanceof vc){var a=s.catch((function(t){return o.done(),vc.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return vc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ft?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function _c(t){return new vc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Sc(t.target.error);n(e)}}))}var Tc=!1;function Sc(t){var e=mc._t(E());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new _o("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Tc||(Tc=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ac=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return i(e,t),e}(dc);function Nc(t,e){var n=Oo(t);return mc.It(n.Mt,e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dc=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Aa(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Na(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Na(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Uo.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),eu())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mo(this.mutations,t.mutations,(function(t,e){return Ca(t,e)}))&&Mo(this.baseMutations,t.baseMutations,(function(t,e){return Ca(t,e)}))},t}(),Cc=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){ko(e.mutations.length===r.length);for(var i=Za(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Rc=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Uo.min()),void 0===o&&(o=Uo.min()),void 0===s&&(s=Wo.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),kc=function(t){this.Lt=t};function Oc(t,e){if(e.document)return Cu(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=os.fromSegments(e.noDocument.path),r=Fc(e.noDocument.readTime),i=Is.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=os.fromSegments(e.unknownDocument.path);return r=Fc(e.unknownDocument.version),Is.newUnknownDocument(o,r)}return Ro()}function xc(t,e,n){var r=Lc(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Iu(t,e.key),fields:e.data.value.mapValue.fields,updateTime:vu(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new rc(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=Mc(e.version);return s=e.hasCommittedMutations,new rc(null,new ec(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Mc(e.version);return new rc(new nc(c,h),null,null,!0,r,i)}return Ro()}function Lc(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Pc(t){var e=new Vo(t[0],t[1]);return Uo.fromTimestamp(e)}function Mc(t){var e=t.toTimestamp();return new Xu(e.seconds,e.nanoseconds)}function Fc(t){var e=new Vo(t.seconds,t.nanoseconds);return Uo.fromTimestamp(e)}function Vc(t,e){for(var n=(e.baseMutations||[]).map((function(e){return ku(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return ku(t.Lt,e)})),a=Vo.fromMillis(e.localWriteTimeMs);return new Dc(e.batchId,a,n,s)}function Uc(t){var e,n,r=Fc(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Fc(t.lastLimboFreeSnapshotVersion):Uo.min();return void 0!==t.query.documents?(ko(1===(n=t.query).documents.length),e=Js(Gs(Su(n.documents[0])))):e=function(t){return Js(Lu(t))}(t.query),new Rc(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Wo.fromBase64String(t.resumeToken))}function qc(t,e){var n,r=Mc(e.snapshotVersion),i=Mc(e.lastLimboFreeSnapshotVersion);n=Ns(e.target)?Ou(t.Lt,e.target):xu(t.Lt,e.target);var o=e.resumeToken.toBase64();return new oc(e.targetId,Ss(e.target),r,o,e.sequenceNumber,i,n)}function jc(t){var e=Lu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Zs(e,e.limit,"L"):e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bc=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Kc(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Fc(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Kc(t).put({bundleId:(n=e).id,createTime:Mc(bu(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return zc(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:jc(e.bundledQuery),readTime:Fc(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return zc(t).put(function(t){return{name:t.name,readTime:Mc(bu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Kc(t){return Nc(t,hc.store)}function zc(t){return Nc(t,lc.store)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gc=function(){function t(){this.Bt=new Hc}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),vc.resolve()},t.prototype.getCollectionParents=function(t,e){return vc.resolve(this.Bt.getEntries(e))},t}(),Hc=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Ha(zo.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Ha(zo.comparator)).toArray()},t}(),Qc=function(){function t(){this.qt=new Hc}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Hu(i)};return Wc(t).put(o)}return vc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Fo(e),""],!1,!0);return Wc(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Yu(o.parent))}return n}))},t}();function Wc(t){return Nc(t,uc.store)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Xc=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(t,e,n){var r=t.store(Zu.store),i=t.store(tc.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){ko(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=tc.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return vc.waitFor(o).next((function(){return c}))}function Jc(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ro();e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xc.DEFAULT_COLLECTION_PERCENTILE=10,Xc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xc.DEFAULT=new Xc(41943040,Xc.DEFAULT_COLLECTION_PERCENTILE,Xc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xc.DISABLED=new Xc(-1,0,0);var Zc=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return ko(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return eh(t).$t({index:Zu.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=nh(t),s=eh(t);return s.add({}).next((function(a){ko("number"==typeof a);for(var u=new Dc(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Ru(t.Lt,e)})),i=n.mutations.map((function(e){return Ru(t.Lt,e)}));return new Zu(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new Ha((function(t,e){return Po(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],y=tc.key(i.userId,d.key.path,a);l=l.add(d.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,tc.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),vc.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return eh(t).get(e).next((function(t){return t?(ko(t.userId===n.userId),Vc(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?vc.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return eh(t).$t({index:Zu.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(ko(e.batchId>=r),o=Vc(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return eh(t).$t({index:Zu.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return eh(t).Nt(Zu.userMutationsIndex,n).next((function(t){return t.map((function(t){return Vc(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=tc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return nh(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=Yu(u);if(a===n.userId&&e.path.isEqual(h))return eh(t).get(c).next((function(t){if(!t)throw Ro();ko(t.userId===n.userId),o.push(Vc(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Ha(Po),i=[];return e.forEach((function(e){var o=tc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=nh(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=Yu(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),vc.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=tc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Ha(Po);return nh(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=Yu(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(eh(t).get(e).next((function(t){if(null===t)throw Ro();ko(t.userId===n.userId),r.push(Vc(n.R,t))})))})),vc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return $c(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),vc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return vc.resolve();var r=IDBKeyRange.lowerBound(tc.prefixForUser(e.userId)),i=[];return nh(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Yu(t[1]);i.push(o)}else r.done()})).next((function(){ko(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return th(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return rh(t).get(this.userId).next((function(t){return t||new Ju(e.userId,-1,"")}))},t}();function th(t,e,n){var r=tc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return nh(t).$t({range:o,Ft:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function eh(t){return Nc(t,Zu.store)}function nh(t){return Nc(t,tc.store)}function rh(t){return Nc(t,Ju.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ih=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),oh=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new ih(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return Uo.fromTimestamp(new Vo(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return sh(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return ko(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return sh(t).$t((function(s,a){var u=Uc(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return vc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return sh(t).$t((function(t,n){var r=Uc(n);e(r)}))},t.prototype.Xt=function(t){return ah(t).get(ac.key).next((function(t){return ko(null!==t),t}))},t.prototype.Zt=function(t,e){return ah(t).put(ac.key,e)},t.prototype.te=function(t,e){return sh(t).put(qc(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=Ss(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return sh(t).$t({range:r,index:oc.queryTargetsIndexName},(function(t,n,r){var o=Uc(n);As(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=uh(t);return e.forEach((function(e){var s=Hu(e.path);i.push(o.put(new sc(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),vc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=uh(t);return vc.forEach(e,(function(e){var o=Hu(e.path);return vc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=uh(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=uh(t),i=eu();return r.$t({range:n,Ft:!0},(function(t,e,n){var r=Yu(t[1]),o=new os(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Hu(e.path),r=IDBKeyRange.bound([n],[Fo(n)],!1,!0),i=0;return uh(t).$t({index:sc.documentTargetsIndex,Ft:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return sh(t).get(e).next((function(t){return t?Uc(t):null}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(t){return Nc(t,oc.store)}function ah(t){return Nc(t,ac.store)}function uh(t){return Nc(t,sc.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ch(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){if(t.code!==Io.FAILED_PRECONDITION||t.message!==pc)throw t;return Ao("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hh(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Po(n,i);return 0===s?Po(r,o):s}var lh=function(){function t(t){this.ne=t,this.buffer=new Ha(hh),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();hh(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),fh=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Ao("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return s(e,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Ec(e=n.sent())?(Ao("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ch(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),ph=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return vc.resolve(Eo.o);var r=new lh(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Ao("LruGarbageCollector","Garbage collection skipped; disabled"),vc.resolve(Yc)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Ao("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Yc):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(Ao("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),So()<=X.DEBUG&&Ao("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),vc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),dh=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new ph(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return yh(t,n)},t.prototype.removeReference=function(t,e,n){return yh(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return yh(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return rh(t).Ot((function(r){return th(t,r,e).next((function(t){return t&&(n=!0),vc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),uh(t).delete([0,Hu(s.path)])}))}));i.push(u)}})).next((function(){return vc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return yh(t,e)},t.prototype.we=function(t,e){var n,r=uh(t),i=Eo.o;return r.$t({index:sc.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==Eo.o&&e(new os(Yu(n)),i),i=a,n=s):i=Eo.o})).next((function(){i!==Eo.o&&e(new os(Yu(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function yh(t,e){return uh(t).put(function(t,e){return new sc(0,Hu(t.path),e)}(e,t.currentSequenceNumber))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vh=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){jo(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return Bo(this.inner)},t}(),gh=function(){function t(){this.changes=new vh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Uo.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Is.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?vc.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),mh=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Eh(t).put(Ih(e),n)},t.prototype.removeEntry=function(t,e){var n=Eh(t),r=Ih(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Eh(t).get(Ih(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return Eh(t).get(Ih(e)).next((function(t){return{document:n.ye(e,t),size:Jc(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Ya();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Ya(),i=new Ka(os.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Jc(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return vc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Eh(t).$t({range:r},(function(t,e,r){for(var s=os.fromSegments(t);o&&os.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Ya(),o=e.path.length+1,s={};if(n.isEqual(Uo.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=Lc(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=rc.collectionReadTimeIndex}return Eh(t).$t(s,(function(t,n,s){if(t.length===o){var a=Oc(r.R,n);e.path.isPrefixOf(a.key.path)?ra(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new bh(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return wh(t).get(ic.key).next((function(t){return ko(!!t),t}))},t.prototype.me=function(t,e){return wh(t).put(ic.key,e)},t.prototype.ye=function(t,e){if(e){var n=Oc(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(Uo.min()))return n}return Is.newInvalidDocument(t)},t}(),bh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new vh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return i(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Ha((function(t,e){return Po(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=xc(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Jc(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=xc(e.Ie.R,Is.newNoDocument(o,Uo.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),vc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(gh);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(t){return Nc(t,ic.store)}function Eh(t){return Nc(t,rc.store)}function Ih(t){return t.path.toArray()}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _h=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;ko(n<r&&n>=0&&r<=11);var o=new gc("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore($u.store)}(t),function(t){t.createObjectStore(Ju.store,{keyPath:Ju.keyPath}),t.createObjectStore(Zu.store,{keyPath:Zu.keyPath,autoIncrement:!0}).createIndex(Zu.userMutationsIndex,Zu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(tc.store)}(t),Th(t),function(t){t.createObjectStore(rc.store)}(t));var s=vc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(sc.store),t.deleteObjectStore(oc.store),t.deleteObjectStore(ac.store)}(t),Th(t)),s=s.next((function(){return function(t){var e=t.store(ac.store),n=new ac(0,0,Uo.min().toTimestamp(),0);return e.put(ac.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Zu.store).Nt().next((function(n){t.deleteObjectStore(Zu.store),t.createObjectStore(Zu.store,{keyPath:Zu.keyPath,autoIncrement:!0}).createIndex(Zu.userMutationsIndex,Zu.userMutationsKeyPath,{unique:!0});var r=e.store(Zu.store),i=n.map((function(t){return r.put(t)}));return vc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(cc.store,{keyPath:cc.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(ic.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(rc.store);e.createIndex(rc.readTimeIndex,rc.readTimeIndexPath,{unique:!1}),e.createIndex(rc.collectionReadTimeIndex,rc.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(hc.store,{keyPath:hc.keyPath})}(t),function(t){t.createObjectStore(lc.store,{keyPath:lc.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(rc.store).$t((function(t,n){e+=Jc(n)})).next((function(){var n=new ic(e);return t.store(ic.store).put(ic.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Ju.store),r=t.store(Zu.store);return n.Nt().next((function(n){return vc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Zu.userMutationsIndex,i).next((function(r){return vc.forEach(r,(function(r){ko(r.userId===n.userId);var i=Vc(e.R,r);return $c(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(sc.store),n=t.store(rc.store);return t.store(ac.store).get(ac.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new zo(n),s=function(t){return[0,Hu(t)]}(o);r.push(e.get(s).next((function(n){return n?vc.resolve():function(n){return e.put(new sc(0,Hu(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return vc.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(uc.store,{keyPath:uc.keyPath});var n=e.store(uc.store),r=new Hc,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Hu(i)})}};return e.store(rc.store).$t({Ft:!0},(function(t,e){var n=new zo(t);return i(n.popLast())})).next((function(){return e.store(tc.store).$t({Ft:!0},(function(t,e){t[0];var n=t[1];t[2];var r=Yu(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(oc.store);return n.$t((function(t,r){var i=Uc(r),o=qc(e.R,i);return n.put(o)}))},t}();function Th(t){t.createObjectStore(sc.store,{keyPath:sc.keyPath}).createIndex(sc.documentTargetsIndex,sc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(oc.store,{keyPath:oc.keyPath}).createIndex(oc.queryTargetsIndexName,oc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ac.store)}var Sh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ah=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new _o(Io.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new dh(this,i),this.Le=n+"main",this.R=new kc(u),this.Be=new mc(this.Le,11,new _h(this.R)),this.qe=new oh(this.referenceDelegate,this.R),this.Ut=new Qc,this.Ue=function(t,e){return new mh(t,e)}(this.R,this.Ut),this.Ke=new Bc,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&No("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new _o(Io.FAILED_PRECONDITION,Sh);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new Eo(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return s(e,void 0,void 0,(function(){return a(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return s(e,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return s(e,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Dh(e).put(new cc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(Ec(e))return Ao("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Ao("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Nh(t).get($u.key).next((function(t){return vc.resolve(e.tn(t))}))},t.prototype.en=function(t){return Dh(t).delete(this.clientId)},t.prototype.nn=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i=this;return a(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Nc(t,cc.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return vc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?vc.resolve(!0):Nh(t).get($u.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new _o(Io.FAILED_PRECONDITION,Sh);return!1}}return!(!e.networkEnabled||!e.inForeground)||Dh(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Ao("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return s(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[$u.store,cc.store],(function(e){var n=new Ac(e,Eo.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Dh(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Zc.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Ao("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,fc,(function(o){return i=new Ac(o,r.Ne?r.Ne.next():Eo.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw No("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new _o(Io.FAILED_PRECONDITION,pc);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Nh(t).get($u.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new _o(Io.FAILED_PRECONDITION,Sh)}))},t.prototype.Ze=function(t){var e=new $u(this.clientId,this.allowTabSynchronization,Date.now());return Nh(t).put($u.key,e)},t.yt=function(){return mc.yt()},t.prototype.Xe=function(t){var e=this,n=Nh(t);return n.get($u.key).next((function(t){return e.tn(t)?(Ao("IndexedDbPersistence","Releasing primary lease."),n.delete($u.key)):vc.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(No("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ke=function(){e.un(),R()&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.ke))},t.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Ao("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return No("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){No("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Nh(t){return Nc(t,$u.store)}function Dh(t){return Nc(t,cc.store)}function Ch(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var Rh=function(t,e){this.progress=t,this.wn=e},kh=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return os.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Xs(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new os(e)).next((function(t){var e=$a();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=$a();return this.Ut.getCollectionParents(t,i).next((function(s){return vc.forEach(s,(function(s){var a=function(t,e){return new Ks(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=Is.newInvalidDocument(c),r=r.insert(c,h)),Na(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){ra(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=eu(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Oa&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Oh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=eu(),i=eu(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),xh=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Uo.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(Hs(e)||Qs(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(So()<=X.DEBUG&&Ao("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),na(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Ha(ia(t));return e.forEach((function(e,r){ra(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return So()<=X.DEBUG&&Ao("QueryEngine","Using full collection scan to execute query:",na(e)),this.Sn.getDocumentsMatchingQuery(t,e,Uo.min())},t}(),Lh=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.kn=new Ka(Po),this.Fn=new vh((function(t){return Ss(t)}),As),this.$n=Uo.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new kh(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.kn)}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(t,e,n,r){return new Lh(t,e,n,r)}function Mh(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o;return a(this,(function(s){switch(s.label){case 0:return n=Oo(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new kh(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=eu(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var v=0,g=y.mutations;v<g.length;v++){var m=g[v];s=s.add(m.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function Fh(t,e){var n=Oo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=vc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);ko(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Vh(t){var e=Oo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Uh(t,e){var n=Oo(t),r=e.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return ko(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=Ya();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(qh(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(Uo.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return vc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.kn=i,t}))}function qh(t,e,n,r,i){var o=eu();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Ya();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(Uo.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Ao("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}function jh(t,e){var n=Oo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Bh(t,e){var n=Oo(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,vc.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Rc(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.kn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(t.targetId,t),n.Fn.set(e,t.targetId)),t}))}function Kh(t,e,n){return s(this,void 0,void 0,(function(){var r,i,o,s;return a(this,(function(a){switch(a.label){case 0:r=Oo(t),i=r.kn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Ec(s=a.sent()))throw s;return Ao("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.kn=r.kn.remove(e),r.Fn.delete(i.target),[2]}}))}))}function zh(t,e,n){var r=Oo(t),i=Uo.min(),o=eu();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Oo(t),i=r.Fn.get(n);return void 0!==i?vc.resolve(r.kn.get(i)):r.qe.getTargetData(e,n)}(r,t,Js(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:Uo.min(),n?o:eu())})).next((function(t){return{documents:t,Bn:o}}))}))}function Gh(t,e){var n=Oo(t),r=Oo(n.qe),i=n.kn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Hh(t){var e=Oo(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Oo(t),i=Ya(),o=Lc(n),s=Eh(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:rc.readTimeIndex,range:a},(function(t,e){var n=Oc(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Pc(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function Qh(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){return[2,(e=Oo(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Eh(t),n=Uo.min();return e.$t({index:rc.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Pc(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}function Wh(t,e,n,r){return s(this,void 0,void 0,(function(){var i,o,s,u,c,h,l,f,p,d;return a(this,(function(a){switch(a.label){case 0:for(i=Oo(t),o=eu(),s=Ya(),u=Za(),c=0,h=n;c<h.length;c++)l=h[c],f=e.qn(l.metadata.name),l.document&&(o=o.add(f)),s=s.insert(f,e.Un(l)),u=u.insert(f,e.Kn(l.metadata.readTime));return p=i.On.newChangeBuffer({trackRemovals:!0}),[4,Bh(i,function(t){return Js(Gs(zo.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=a.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return qh(t,p,s,Uo.min(),u).next((function(e){return p.apply(t),e})).next((function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next((function(){return i.qe.addMatchingKeys(t,o,d.targetId)})).next((function(){return i.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function Yh(t,e,n){return void 0===n&&(n=eu()),s(this,void 0,void 0,(function(){var r,i;return a(this,(function(o){switch(o.label){case 0:return[4,Bh(t,Js(jc(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Oo(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=bu(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(t,e);var s=r.withResumeToken(Wo.EMPTY_BYTE_STRING,o);return i.kn=i.kn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next((function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.Ke.saveNamedQuery(t,e)}))}))]}}))}))
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var Xh=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return vc.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:bu(n.createTime)}),vc.resolve()},t.prototype.getNamedQuery=function(t,e){return vc.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:jc(t.bundledQuery),readTime:bu(t.readTime)}}(e)),vc.resolve()},t}(),$h=function(){function t(){this.Wn=new Ha(Jh.Gn),this.zn=new Ha(Jh.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Jh(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Jh(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new os(new zo([])),r=new Jh(n,t),i=new Jh(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new os(new zo([])),n=new Jh(e,t),r=new Jh(e,t+1),i=eu();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Jh(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Jh=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return os.comparator(t.key,e.key)||Po(t.ns,e.ns)},t.Hn=function(t,e){return Po(t.ns,e.ns)||os.comparator(t.key,e.key)},t}(),Zh=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Ha(Jh.Gn)}return t.prototype.checkEmpty=function(t){return vc.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new Dc(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new Jh(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return vc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return vc.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return vc.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return vc.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return vc.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Jh(e,0),i=new Jh(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),vc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Ha(Po);return e.forEach((function(t){var e=new Jh(t,0),i=new Jh(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),vc.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;os.isDocumentKey(i)||(i=i.child(""));var o=new Jh(new os(i),0),s=new Ha(Po);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),vc.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;ko(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return vc.forEach(e.mutations,(function(i){var o=new Jh(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Jh(e,0),r=this.rs.firstAfterOrEqual(n);return vc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,vc.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),tl=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Ka(os.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return vc.resolve(n?n.document.clone():Is.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Ya();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Is.newInvalidDocument(t))})),vc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Ya(),i=new os(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;h.compareTo(n)<=0||ra(e,c)&&(r=r.insert(c.key,c.clone()))}return vc.resolve(r)},t.prototype.fs=function(t,e){return vc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new el(this)},t.prototype.getSize=function(t){return vc.resolve(this.size)},t}(),el=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return i(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),vc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(gh),nl=function(){function t(t){this.persistence=t,this.ds=new vh((function(t){return Ss(t)}),As),this.lastRemoteSnapshotVersion=Uo.min(),this.highestTargetId=0,this.ws=0,this._s=new $h,this.targetCount=0,this.ys=ih.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),vc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return vc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return vc.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),vc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),vc.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new ih(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,vc.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),vc.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,vc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),vc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return vc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return vc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),vc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),vc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),vc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return vc.resolve(n)},t.prototype.containsKey=function(t,e){return vc.resolve(this._s.containsKey(e))},t}(),rl=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Eo(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new nl(this),this.Ut=new Gc,this.Ue=function(t,e){return new tl(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new kc(e),this.Ke=new Xh(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Zh(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Ao("MemoryPersistence","Starting transaction:",t);var i=new il(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return vc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),il=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return i(e,t),e}(dc),ol=function(){function t(t){this.persistence=t,this.As=new $h,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Ro()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),vc.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),vc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),vc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return vc.forEach(this.vs,(function(r){var i=os.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return vc.or([function(){return vc.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),sl=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(t,e){return"firestore_clients_"+t+"_"+e}function ul(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function cl(t,e){return"firestore_targets_"+t+"_"+e}sl.UNAUTHENTICATED=new sl(null),sl.GOOGLE_CREDENTIALS=new sl("google-credentials-uid"),sl.FIRST_PARTY=new sl("first-party-uid"),sl.MOCK_USER=new sl("mock-user");var hl=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new _o(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(No("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ll=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new _o(i.error.code,i.error.message)),o?new t(e,i.state,r):(No("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),fl=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=ru(),s=0;i&&s<r.activeTargetIds.length;++s)i=is(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(No("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),pl=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(No("SharedClientState","Failed to parse online state: "+e),null)},t}(),dl=function(){function t(){this.activeTargetIds=ru()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),yl=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new Ka(Po),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=al(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new dl),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,c,h,l,f=this;return a(this,(function(a){switch(a.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=a.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(al(this.persistenceKey,r)))&&(o=fl.Vs(r,i))&&(this.Fs=this.Fs.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(u=this.js(s))&&this.Ws(u),c=0,h=this.$s;c<h.length;c++)l=h[c],this.ks(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.Fs.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(cl(this.persistenceKey,t));if(n){var r=ll.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(cl(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ao("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Ao("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Ao("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.ks=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Ao("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void No("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return s(e,void 0,void 0,(function(){var t,e,r,i,o,s;return a(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Eo.o;if(null!=t)try{var n=JSON.parse(t);ko("number"==typeof n),e=n}catch(t){No("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Eo.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new hl(this.currentUser,t,e,n),i=ul(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=ul(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=cl(this.persistenceKey,t),i=new ll(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return fl.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return hl.Vs(new sl(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return ll.Vs(r,e)},t.prototype.js=function(t){return pl.Vs(t)},t.prototype.ii=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Ao("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.Fs.insert(t,e):this.Fs.remove(t),i=this.Gs(this.Fs),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.Fs=r}))},t.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=ru();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),vl=function(){function t(){this.li=new dl,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new dl,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),gl=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),ml=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Ao("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Ao("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),bl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},wl=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),El=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return i(e,t),e.prototype.Fi=function(t,e,n,r){return new Promise((function(i,o){var s=new wo;s.listenOnce(yo.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case po.NO_ERROR:var e=s.getResponseJson();Ao("Connection","XHR received:",JSON.stringify(e)),i(e);break;case po.TIMEOUT:Ao("Connection",'RPC "'+t+'" timed out'),o(new _o(Io.DEADLINE_EXCEEDED,"Request time out"));break;case po.HTTP_ERROR:var n=s.getStatus();if(Ao("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Io).indexOf(e)>=0?e:Io.UNKNOWN}(r.status);o(new _o(a,r.message))}else o(new _o(Io.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new _o(Io.UNAVAILABLE,"Connection failed."));break;default:Ro()}}finally{Ao("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=lo(),i=fo(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new mo({})),this.ki(o.initMessageHeaders,e),I()||A()||N()||D()||C()||S()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Ao("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new wl({Ei:function(t){c?Ao("Connection","Not sending because WebChannel is closed:",t):(u||(Ao("Connection","Opening WebChannel transport."),a.open(),u=!0),Ao("Connection","WebChannel sending:",t),a.send(t))},Ti:function(){return a.close()}}),l=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return l(a,bo.EventType.OPEN,(function(){c||Ao("Connection","WebChannel transport opened.")})),l(a,bo.EventType.CLOSE,(function(){c||(c=!0,Ao("Connection","WebChannel transport closed"),h.Vi())})),l(a,bo.EventType.ERROR,(function(t){c||(c=!0,Do("Connection","WebChannel transport errored:",t),h.Vi(new _o(Io.UNAVAILABLE,"The operation could not be completed")))})),l(a,bo.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];ko(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Ao("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Ma[t];if(void 0!==e)return Ba(e)}(o),u=i.message;void 0===s&&(s=Io.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),c=!0,h.Vi(new _o(s,u)),a.close()}else Ao("Connection","WebChannel received:",n),h.Si(n)}})),l(i,vo.STAT_EVENT,(function(t){t.stat===go.PROXY?Ao("Connection","Detected buffering proxy"):t.stat===go.NOPROXY&&Ao("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Ao("RestConnection","Sending: ",i,n);var o={};return this.ki(o,r),this.Fi(t,i,o,n).then((function(t){return Ao("RestConnection","Received: ",t),t}),(function(e){throw Do("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.ki=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.1",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=bl[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Il(){return"undefined"!=typeof window?window:null}function _l(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(t){return new yu(t,!0)}var Sl=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Ao("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Al=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Sl(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return s(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Io.RESOURCE_EXHAUSTED?(No(e.toString()),No("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Io.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new _o(Io.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return s(t,void 0,void 0,(function(){return a(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return Ao("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(Ao("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Nl=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return i(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ro()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(ko(void 0===e||"string"==typeof e),Wo.fromBase64String(e||"")):(ko(void 0===e||e instanceof Uint8Array),Wo.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Io.UNKNOWN:Ba(t.code);return new _o(e,t.message||"")}(a);n=new uu(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=_u(t,r.document.name),o=bu(r.document.updateTime);var a=new ws({mapValue:{fields:r.document.fields}}),u=(s=Is.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new su(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=_u(t,r.document),o=r.readTime?bu(r.readTime):Uo.min(),a=Is.newNoDocument(i,o),s=r.removedTargetIds||[],n=new su([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=_u(t,r.document),o=r.removedTargetIds||[],n=new su([],o,i,null);else{if(!("filter"in e))return Ro();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new qa(r),o=h.targetId,n=new au(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return Uo.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Uo.min():e.readTime?bu(e.readTime):Uo.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Au(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Ns(r)?{documents:Ou(t,r)}:{query:xu(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=gu(t,e.resumeToken):e.snapshotVersion.compareTo(Uo.min())>0&&(n.readTime=vu(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ro()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Au(this.R),e.removeTarget=t,this.cr(e)},e}(Al),Dl=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return i(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(ko(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(ko(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?bu(t.updateTime):bu(e);return n.isEqual(Uo.min())&&(n=bu(e)),new Ia(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=bu(t.commitTime);return this.listener.Tr(n,e)}return ko(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Au(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Ru(e.R,t)}))};this.cr(n)},e}(Al),Cl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return i(e,t),e.prototype.br=function(){if(this.Rr)throw new _o(Io.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Io.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new _o(Io.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Io.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new _o(Io.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Rl=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.kr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(No(e),this.Vr=!1):Ao("OnlineStateTracker",e)},t.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),kl=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return s(o,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return ql(this)?(Ao("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return(e=Oo(t)).Or.add(4),[4,xl(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Ol(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Rl(n,r)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ol(t){return s(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:if(!ql(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function xl(t){return s(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Ll(t,e){var n=Oo(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Ul(n)?Vl(n):ef(n).er()&&Ml(n,e))}function Pl(t,e){var n=Oo(t),r=ef(n);n.$r.delete(e),r.er()&&Fl(n,e),0===n.$r.size&&(r.er()?r.ir():ql(n)&&n.Br.set("Unknown"))}function Ml(t,e){t.qr.U(e.targetId),ef(t).mr(e)}function Fl(t,e){t.qr.U(e),ef(t).yr(e)}function Vl(t){t.qr=new hu({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),ef(t).start(),t.Br.Sr()}function Ul(t){return ql(t)&&!ef(t).tr()&&t.$r.size>0}function ql(t){return 0===Oo(t).Or.size}function jl(t){t.qr=void 0}function Bl(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return t.$r.forEach((function(e,n){Ml(t,e)})),[2]}))}))}function Kl(t,e){return s(this,void 0,void 0,(function(){return a(this,(function(n){return jl(t),Ul(t)?(t.Br.Nr(e),Vl(t)):t.Br.set("Unknown"),[2]}))}))}function zl(t,e,n){return s(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(u){switch(u.label){case 0:if(t.Br.set("Online"),!(e instanceof uu&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o;return a(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return u.sent(),[3,5];case 3:return r=u.sent(),Ao("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Gl(t,r)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof su?t.qr.X(e):e instanceof au?t.qr.rt(e):t.qr.et(e),n.isEqual(Uo.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,Vh(t.localStore)];case 8:return i=u.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(Wo.EMPTY_BYTE_STRING,n.snapshotVersion)),Fl(t,e);var r=new Rc(n.target,e,1,n.sequenceNumber);Ml(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return Ao("RemoteStore","Failed to raise snapshot:",o=u.sent()),[4,Gl(t,o)];case 12:return u.sent(),[3,13];case 13:return[2]}}))}))}function Gl(t,e,n){return s(this,void 0,void 0,(function(){var r=this;return a(this,(function(i){switch(i.label){case 0:if(!Ec(e))throw e;return t.Or.add(1),[4,xl(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return Vh(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return s(r,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return Ao("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Ol(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Hl(t,e){return e().catch((function(n){return Gl(t,n,e)}))}function Ql(t){return s(this,void 0,void 0,(function(){var e,n,r,i,o;return a(this,(function(s){switch(s.label){case 0:e=Oo(t),n=nf(e),r=e.Fr.length>0?e.Fr[e.Fr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return ql(t)&&t.Fr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,jh(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.Fr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.Fr.push(e);var n=nf(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Gl(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Wl(e)&&Yl(e),[2]}}))}))}function Wl(t){return ql(t)&&!nf(t).tr()&&t.Fr.length>0}function Yl(t){nf(t).start()}function Xl(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return nf(t).Ar(),[2]}))}))}function $l(t){return s(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(o){for(e=nf(t),n=0,r=t.Fr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function Jl(t,e,n){return s(this,void 0,void 0,(function(){var r,i;return a(this,(function(o){switch(o.label){case 0:return r=t.Fr.shift(),i=Cc.from(r,e,n),[4,Hl(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,Ql(t)];case 2:return o.sent(),[2]}}))}))}function Zl(t,e){return s(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return e&&nf(t).pr?[4,function(t,e){return s(this,void 0,void 0,(function(){var n,r;return a(this,(function(i){switch(i.label){case 0:return ja(r=e.code)&&r!==Io.ABORTED?(n=t.Fr.shift(),nf(t).sr(),[4,Hl(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Ql(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Wl(t)&&Yl(t),[2]}}))}))}function tf(t,e){return s(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return n=Oo(t),e?(n.Or.delete(2),[4,Ol(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,xl(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function ef(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Oo(t);return r.br(),new Nl(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Bl.bind(null,t),Ri:Kl.bind(null,t),_r:zl.bind(null,t)}),t.Mr.push((function(n){return s(e,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Ul(t)?Vl(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),jl(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function nf(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=Oo(t);return r.br(),new Dl(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Xl.bind(null,t),Ri:Zl.bind(null,t),Ir:$l.bind(null,t),Tr:Jl.bind(null,t)}),t.Mr.push((function(n){return s(e,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,Ql(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.Fr.length>0&&(Ao("RemoteStore","Stopping write stream with "+t.Fr.length+" pending writes"),t.Fr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var rf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new yc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new _o(Io.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function of(t,e){if(No("AsyncQueue",e+": "+t),Ec(t))return new _o(Io.UNAVAILABLE,e+": "+t);throw t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sf=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||os.comparator(e.key,n.key)}:function(t,e){return os.comparator(t.key,e.key)},this.keyedMap=$a(),this.sortedSet=new Ka(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),af=function(){function t(){this.Qr=new Ka(os.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Ro():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),uf=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,sf.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ta(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),cf=function(){this.Wr=void 0,this.listeners=[]},hf=function(){this.queries=new vh((function(t){return ea(t)}),ta),this.onlineState="Unknown",this.Gr=new Set};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,s,u,c;return a(this,(function(a){switch(a.label){case 0:if(n=Oo(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new cf),!i)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=a.sent(),[3,4];case 3:return u=a.sent(),c=of(u,"Initialization of query '"+na(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&yf(n),[2]}}))}))}function ff(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,s;return a(this,(function(a){return n=Oo(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function pf(t,e){for(var n=Oo(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);u.Wr=s}}r&&yf(n)}function df(t,e,n){var r=Oo(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function yf(t){t.Gr.forEach((function(t){t.next()}))}var vf=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new uf(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=uf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),gf=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),mf=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return _u(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Cu(this.R,t.document,!1):Is.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return bu(t)},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=bf(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new mf(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||eu()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i;return a(this,(function(o){switch(o.label){case 0:return[4,Wh(this.localStore,new mf(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,Yh(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Rh(Object.assign({},this.progress),t))]}}))}))}})();function bf(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wf=function(t){this.key=t},Ef=function(t){this.key=t},If=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=eu(),this.mutatedKeys=eu(),this.lo=ia(t),this.fo=new sf(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new af,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=Hs(this.query)&&i.size===this.query.limit?i.last():null,c=Qs(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=ra(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data.isEqual(l.data)?f!==p&&(r.track({type:3,doc:l}),d=!0):n.yo(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Hs(this.query)||Qs(this.query))for(;s.size>this.query.limit;){var h=Hs(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ro()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new uf(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new af,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=eu(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Ef(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new wf(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=eu();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return uf.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),_f=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Tf=function(t){this.key=t,this.bo=!1},Sf=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new vh((function(t){return ea(t)}),ta),this.Vo=new Map,this.So=new Set,this.Do=new Ka(os.comparator),this.Co=new Map,this.No=new $h,this.xo={},this.ko=new Map,this.Fo=ih.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function Af(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,s,u;return a(this,(function(a){switch(a.label){case 0:return n=ep(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,Bh(n.localStore,Js(e))];case 2:return s=a.sent(),u=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,Nf(n,e,r,"current"===u)];case 3:i=a.sent(),n.isPrimaryClient&&Ll(n.remoteStore,s),a.label=4;case 4:return[2,i]}}))}))}function Nf(t,e,n,r){return s(this,void 0,void 0,(function(){var i,o,u,c,h,l;return a(this,(function(f){switch(f.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return s(this,void 0,void 0,(function(){var i,o,s;return a(this,(function(a){switch(a.label){case 0:return i=e.view._o(n),i.Nn?[4,zh(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(qf(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,zh(t.localStore,e,!0)];case 1:return i=f.sent(),o=new If(e,i.Bn),u=o._o(i.documents),c=ou.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),h=o.applyChanges(u,t.isPrimaryClient,c),qf(t,n,h.To),l=new _f(e,n,o),[2,(t.Po.set(e,l),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),h.snapshot)]}}))}))}function Df(t,e){return s(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(o){switch(o.label){case 0:return n=Oo(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!ta(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Kh(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Pl(n.remoteStore,r.targetId),Vf(n,r.targetId)})).catch(ch)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Vf(n,r.targetId),[4,Kh(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Cf(t,e,n){return s(this,void 0,void 0,(function(){var r,i,o,s;return a(this,(function(a){switch(a.label){case 0:r=np(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Oo(t),i=Vo.now(),o=e.reduce((function(t,e){return t.add(e.key)}),eu());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=Da(c,n.get(c.key));null!=h&&s.push(new Oa(c.key,h,Es(h.value.mapValue),_a.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Ka(Po)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Kf(r,i.changes)];case 3:return a.sent(),[4,Ql(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=of(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function Rf(t,e){return s(this,void 0,void 0,(function(){var n,r;return a(this,(function(i){switch(i.label){case 0:n=Oo(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Uh(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(ko(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?ko(r.bo):t.removedDocuments.size>0&&(ko(r.bo),r.bo=!1))})),[4,Kf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,ch(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function kf(t,e,n){var r=Oo(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Oo(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&yf(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Of(t,e,n){return s(this,void 0,void 0,(function(){var r,i,o,s,u,c;return a(this,(function(a){switch(a.label){case 0:return(r=Oo(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new Ka(os.comparator)).insert(o,Is.newNoDocument(o,Uo.min())),u=eu().add(o),c=new iu(Uo.min(),new Map,new Ha(Po),s,u),[4,Rf(r,c)]):[3,2];case 1:return a.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Bf(r),[3,4];case 2:return[4,Kh(r.localStore,e,!1).then((function(){return Vf(r,e,n)})).catch(ch)];case 3:a.sent(),a.label=4;case 4:return[2]}}))}))}function xf(t,e){return s(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(o){switch(o.label){case 0:n=Oo(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Fh(n.localStore,e)];case 2:return i=o.sent(),Ff(n,r,null),Mf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Kf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,ch(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Lf(t,e,n){return s(this,void 0,void 0,(function(){var r,i;return a(this,(function(o){switch(o.label){case 0:r=Oo(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Oo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return ko(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),Ff(r,e,n),Mf(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Kf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,ch(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Pf(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,s;return a(this,(function(a){switch(a.label){case 0:ql((n=Oo(t)).remoteStore)||Ao("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Oo(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.ko.get(r)||[]).push(e),n.ko.set(r,i),[3,4]);case 3:return o=a.sent(),s=of(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function Mf(t,e){(t.ko.get(e)||[]).forEach((function(t){t.resolve()})),t.ko.delete(e)}function Ff(t,e,n){var r=Oo(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Vf(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Uf(t,e)}))}function Uf(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Pl(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Bf(t))}function qf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof wf?(t.No.addReference(o.key,e),jf(t,o)):o instanceof Ef?(Ao("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Uf(t,o.key)):Ro()}}function jf(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Ao("SyncEngine","New document in limbo: "+n),t.So.add(r),Bf(t))}function Bf(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new os(zo.fromString(e)),r=t.Fo.next();t.Co.set(r,new Tf(n)),t.Do=t.Do.insert(n,r),Ll(t.remoteStore,new Rc(Js(Gs(n.path)),r,2,Eo.o))}}function Kf(t,e,n){return s(this,void 0,void 0,(function(){var r,i,o,u;return a(this,(function(c){switch(c.label){case 0:return r=Oo(t),i=[],o=[],u=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,s){u.push(r.Oo(s,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Oh.Pn(s.targetId,t);o.push(e)}})))})),[4,Promise.all(u)]);case 1:return c.sent(),r.vo._r(i),[4,function(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,s,u,c,h,l;return a(this,(function(a){switch(a.label){case 0:n=Oo(t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return vc.forEach(e,(function(e){return vc.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return vc.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return a.sent(),[3,4];case 3:if(!Ec(r=a.sent()))throw r;return Ao("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],u=s.targetId,s.fromCache||(c=n.kn.get(u),h=c.snapshotVersion,l=c.withLastLimboFreeSnapshotVersion(h),n.kn=n.kn.insert(u,l));return[2]}}))}))}(r.localStore,o)];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))}function zf(t,e){return s(this,void 0,void 0,(function(){var n,r;return a(this,(function(i){switch(i.label){case 0:return(n=Oo(t)).currentUser.isEqual(e)?[3,3]:(Ao("SyncEngine","User change. New user:",e.toKey()),[4,Mh(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.ko.forEach((function(t){t.forEach((function(t){t.reject(new _o(Io.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.ko.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Kf(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Gf(t,e){var n=Oo(t),r=n.Co.get(e);if(r&&r.bo)return eu().add(r.key);var i=eu(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Hf(t,e){return s(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(o){switch(o.label){case 0:return[4,zh((n=Oo(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&qf(n,e.targetId,i.To),i)]}}))}))}function Qf(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){return[2,Hh((e=Oo(t)).localStore).then((function(t){return Kf(e,t)}))]}))}))}function Wf(t,e,n,r){return s(this,void 0,void 0,(function(){var i,o;return a(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=Oo(t),r=Oo(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):vc.resolve(null)}))}))}((i=Oo(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Ql(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Ff(i,e,r||null),Mf(i,e),function(t,e){Oo(Oo(t)._n).Gt(e)}(i.localStore,e)):Ro(),s.label=4;case 4:return[4,Kf(i,o)];case 5:return s.sent(),[3,7];case 6:Ao("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function Yf(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,s,u,c,h;return a(this,(function(a){switch(a.label){case 0:return ep(n=Oo(t)),np(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Xf(n,r.toArray())]);case 1:return i=a.sent(),n.$o=!0,[4,tf(n.remoteStore,!0)];case 2:for(a.sent(),o=0,s=i;o<s.length;o++)u=s[o],Ll(n.remoteStore,u);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(c=[],h=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?c.push(e):h=h.then((function(){return Vf(n,e),Kh(n.localStore,e,!0)})),Pl(n.remoteStore,e)})),[4,h]);case 4:return a.sent(),[4,Xf(n,c)];case 5:return a.sent(),function(t){var e=Oo(t);e.Co.forEach((function(t,n){Pl(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new Ka(os.comparator)}(n),n.$o=!1,[4,tf(n.remoteStore,!1)];case 6:a.sent(),a.label=7;case 7:return[2]}}))}))}function Xf(t,e,n){return s(this,void 0,void 0,(function(){var n,r,i,o,s,u,c,h,l,f,p,d,y,v;return a(this,(function(a){switch(a.label){case 0:n=Oo(t),r=[],i=[],o=0,s=e,a.label=1;case 1:return o<s.length?(u=s[o],c=void 0,(h=n.Vo.get(u))&&0!==h.length?[4,Bh(n.localStore,Js(h[0]))]:[3,7]):[3,13];case 2:c=a.sent(),l=0,f=h,a.label=3;case 3:return l<f.length?(p=f[l],d=n.Po.get(p),[4,Hf(n,d)]):[3,6];case 4:(y=a.sent()).snapshot&&i.push(y.snapshot),a.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,Gh(n.localStore,u)];case 8:return v=a.sent(),[4,Bh(n.localStore,v)];case 9:return c=a.sent(),[4,Nf(n,$f(v),u,!1)];case 10:a.sent(),a.label=11;case 11:r.push(c),a.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function $f(t){return zs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Jf(t){var e=Oo(t);return Oo(Oo(e.localStore).persistence).fn()}function Zf(t,e,n,r){return s(this,void 0,void 0,(function(){var i,o,s;return a(this,(function(a){switch(a.label){case 0:return(i=Oo(t)).$o?(Ao("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Hh(i.localStore)];case 3:return o=a.sent(),s=iu.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Kf(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,Kh(i.localStore,e,!0)];case 6:return a.sent(),Vf(i,e,r),[3,8];case 7:Ro(),a.label=8;case 8:return[2]}}))}))}function tp(t,e,n){return s(this,void 0,void 0,(function(){var r,i,o,s,u,c,h,l,f,p;return a(this,(function(d){switch(d.label){case 0:if(!(r=ep(t)).$o)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(Ao("SyncEngine","Adding an already active target "+s),[3,5]):[4,Gh(r.localStore,s)]):[3,6];case 2:return u=d.sent(),[4,Bh(r.localStore,u)];case 3:return c=d.sent(),[4,Nf(r,$f(u),c.targetId,!1)];case 4:d.sent(),Ll(r.remoteStore,c),d.label=5;case 5:return i++,[3,1];case 6:h=function(t){return a(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Kh(r.localStore,t,!1).then((function(){Pl(r.remoteStore,t),Vf(r,t)})).catch(ch)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,f=n,d.label=7;case 7:return l<f.length?(p=f[l],[5,h(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function ep(t){var e=Oo(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Gf.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Of.bind(null,e),e.vo._r=pf.bind(null,e.eventManager),e.vo.Mo=df.bind(null,e.eventManager),e}function np(t){var e=Oo(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Lf.bind(null,e),e}var rp=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return this.R=Tl(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Ph(this.persistence,new xh,t.initialUser,this.R)},t.prototype.qo=function(t){return new rl(ol.bs,this.R)},t.prototype.Bo=function(t){return new vl},t.prototype.terminate=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),ip=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return i(e,t),e.prototype.initialize=function(e){return s(this,void 0,void 0,(function(){var n=this;return a(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,Qh(this.localStore)];case 2:return r.sent(),[4,this.Qo.initialize(this,e)];case 3:return r.sent(),[4,np(this.Qo.syncEngine)];case 4:return r.sent(),[4,Ql(this.Qo.remoteStore)];case 5:return r.sent(),[4,this.persistence.He((function(){return n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(n.localStore),Promise.resolve()}))];case 6:return r.sent(),[2]}}))}))},e.prototype.Ko=function(t){return Ph(this.persistence,new xh,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new fh(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Ch(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Xc.withCacheSize(this.cacheSizeBytes):Xc.DEFAULT;return new Ah(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Il(),_l(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new vl},e}(rp),op=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return i(e,t),e.prototype.initialize=function(e){return s(this,void 0,void 0,(function(){var n,r=this;return a(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof yl?(this.sharedClientState.syncEngine={ui:Wf.bind(null,n),ai:Zf.bind(null,n),hi:tp.bind(null,n),fn:Jf.bind(null,n),ci:Qf.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return s(r,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,Yf(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Il();if(!yl.yt(e))throw new _o(Io.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ch(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new yl(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(ip),sp=function(){function t(){}return t.prototype.initialize=function(t,e){return s(this,void 0,void 0,(function(){var n=this;return a(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return kf(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=zf.bind(null,this.syncEngine),[4,tf(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new hf},t.prototype.createDatastore=function(t){var e,n=Tl(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new El(e));return function(t,e,n){return new Cl(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return kf(s.syncEngine,t,0)},o=ml.yt()?new ml:new gl,new kl(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Sf(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return e=Oo(t),Ao("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,xl(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ap=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),up=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new yc,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return s(this,void 0,void 0,(function(){var t,e,n,r;return a(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new gf(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.Jo=function(){return s(this,void 0,void 0,(function(){var t,e;return a(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return s(this,void 0,void 0,(function(){var t,e;return a(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return s(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new _o(Io.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,s,u;return a(this,(function(a){switch(a.label){case 0:return n=Oo(t),r=Au(n.R)+"/documents",i={documents:e.map((function(t){return Iu(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){ko(!!e.found),e.found.name,e.found.updateTime;var n=_u(t,e.found.name),r=bu(e.found.updateTime),i=new ws({mapValue:{fields:e.found.fields}});return Is.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){ko(!!e.missing),ko(!!e.readTime);var n=_u(t,e.missing),r=bu(e.readTime);return Is.newNoDocument(n,r)}(t,e):Ro()}(n.R,t);s.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=s.get(t.toString());ko(!!e),u.push(e)})),u)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Va(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return s(this,void 0,void 0,(function(){var t,e=this;return a(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=os.fromPath(n);e.mutations.push(new Ua(r,e.precondition(r)))})),[4,function(t,e){return s(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(o){switch(o.label){case 0:return n=Oo(t),r=Au(n.R)+"/documents",i={writes:e.map((function(t){return Ru(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Ro();e=Uo.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new _o(Io.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?_a.updateTime(e):_a.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Uo.min()))throw new _o(Io.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _a.updateTime(e)}return _a.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),cp=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Sl(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return s(t,void 0,void 0,(function(){var t,e,n=this;return a(this,(function(r){return t=new up(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!ns(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ja(e)}return!1},t}(),hp=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=sl.UNAUTHENTICATED,this.clientId=Lo.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return s(r,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return Ao("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new _o(Io.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new yc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return s(t,void 0,void 0,(function(){var t,n;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=of(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(t,e){return s(this,void 0,void 0,(function(){var n,r,i=this;return a(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Ao("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return s(i,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Mh(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function fp(t,e){return s(this,void 0,void 0,(function(){var n,r;return a(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,pp(t)];case 1:return n=i.sent(),Ao("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return s(this,void 0,void 0,(function(){var n,r;return a(this,(function(i){switch(i.label){case 0:return(n=Oo(t)).asyncQueue.verifyOperationInProgress(),Ao("RemoteStore","RemoteStore received new credentials"),r=ql(n),n.Or.add(3),[4,xl(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Ol(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function pp(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Ao("FirestoreClient","Using default OfflineComponentProvider"),[4,lp(t,new rp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function dp(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Ao("FirestoreClient","Using default OnlineComponentProvider"),[4,fp(t,new sp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function yp(t){return pp(t).then((function(t){return t.persistence}))}function vp(t){return pp(t).then((function(t){return t.localStore}))}function gp(t){return dp(t).then((function(t){return t.remoteStore}))}function mp(t){return dp(t).then((function(t){return t.syncEngine}))}function bp(t){return s(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return[4,dp(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Af.bind(null,e.syncEngine),n.onUnlisten=Df.bind(null,e.syncEngine),n)]}}))}))}function wp(t,e,n){var r=this;void 0===n&&(n={});var i=new yc;return t.asyncQueue.enqueueAndForget((function(){return s(r,void 0,void 0,(function(){var r;return a(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new ap({next:function(o){e.enqueueAndForget((function(){return ff(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new _o(Io.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new _o(Io.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new vf(Gs(n.path),o,{includeMetadataChanges:!0,so:!0});return lf(t,s)},[4,bp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Ep(t,e,n){var r=this;void 0===n&&(n={});var i=new yc;return t.asyncQueue.enqueueAndForget((function(){return s(r,void 0,void 0,(function(){var r;return a(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new ap({next:function(n){e.enqueueAndForget((function(){return ff(t,s)})),n.fromCache&&"server"===r.source?i.reject(new _o(Io.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new vf(n,o,{includeMetadataChanges:!0,so:!0});return lf(t,s)},[4,bp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Ip=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},_p=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Tp=new Map,Sp=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Ap=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(sl.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Np=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Dp=function(){function t(t){var e=this;this.currentUser=sl.UNAUTHENTICATED,this.oc=new yc,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){Ao("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Ao("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(Ao("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(ko("string"==typeof n.accessToken),new Sp(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return s(n,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return ko(null===t||"string"==typeof t),new sl(t)},t}(),Cp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=sl.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Rp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Cp(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(sl.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(t,e,n){if(!n)throw new _o(Io.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Op(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new _o(Io.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function xp(t,e,n,r){if(!0===e&&!0===r)throw new _o(Io.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Lp(t){if(!os.isDocumentKey(t))throw new _o(Io.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Pp(t){if(os.isDocumentKey(t))throw new _o(Io.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Mp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Ro()}function Fp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new _o(Io.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Mp(t);throw new _o(Io.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Vp(t,e){if(e<=0)throw new _o(Io.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Up=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new _o(Io.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new _o(Io.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,xp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),qp=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Up({}),this._settingsFrozen=!1,t instanceof _p?(this._databaseId=t,this._credentials=new Ap):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new _o(Io.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _p(t.options.projectId)}(t),this._credentials=new Dp(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new _o(Io.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new _o(Io.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Up(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Ap;switch(t.type){case"gapi":var e=t.client;return ko(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Rp(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new _o(Io.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return t=this,(e=Tp.get(t))&&(Ao("ComponentProvider","Removing Datastore"),Tp.delete(t),e.terminate()),Promise.resolve();var t,e},t}(),jp=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Kp(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Bp=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Kp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Gs(r))||this)._path=r,i.type="collection",i}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new jp(this.firestore,null,new os(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Bp);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=j(t),kp("collection","path",e),t instanceof qp)return Pp(n=zo.fromString.apply(zo,h([e],r))),new Kp(t,null,n);if(!(t instanceof jp||t instanceof Kp))throw new _o(Io.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Pp(n=zo.fromString.apply(zo,h([t.path],r)).child(zo.fromString(e))),new Kp(t.firestore,null,n)}function Gp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=j(t),1===arguments.length&&(e=Lo.u()),kp("doc","path",e),t instanceof qp)return Lp(n=zo.fromString.apply(zo,h([e],r))),new jp(t,null,new os(n));if(!(t instanceof jp||t instanceof Kp))throw new _o(Io.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Lp(n=t._path.child(zo.fromString.apply(zo,h([e],r)))),new jp(t.firestore,t instanceof Kp?t.converter:null,new os(n))}function Hp(t,e){return t=j(t),e=j(e),(t instanceof jp||t instanceof Kp)&&(e instanceof jp||e instanceof Kp)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Qp(t,e){return t=j(t),e=j(e),t instanceof Bp&&e instanceof Bp&&t.firestore===e.firestore&&ta(t._query,e._query)&&t.converter===e.converter
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var Wp=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Sl(this,"async_queue_retry"),this.Ic=function(){var e=_l();e&&Ao("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=_l();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=_l();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new yc;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return s(this,void 0,void 0,(function(){var t,e=this;return a(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Ec(t=n.sent()))throw t;return Ao("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,No("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=rf.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&Ro()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return s(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function Yp(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}(function(){function t(){this._progressObserver={},this._taskCompletionResolver=new yc,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}})();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xp=-1,$p=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new Wp,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return i(e,t),e.prototype._terminate=function(){return this._firestoreClient||Zp(this),this._firestoreClient.terminate()},e}(qp);function Jp(t){return t._firestoreClient||Zp(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Zp(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Ip(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new hp(t._credentials,t._queue,r)}function td(t,e,n){var r=this,i=new yc;return t.asyncQueue.enqueue((function(){return s(r,void 0,void 0,(function(){var r;return a(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,lp(t,n)];case 1:return o.sent(),[4,fp(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Io.FAILED_PRECONDITION||t.code===Io.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function ed(t){if(t._initialized||t._terminated)throw new _o(Io.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new _o(Io.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ho(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),rd=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Wo.fromBase64String(e))}catch(e){throw new _o(Io.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Wo.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),id=function(t){this._methodName=t},od=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new _o(Io.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new _o(Io.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Po(this._lat,t._lat)||Po(this._long,t._long)},t}(),sd=/^__.*__$/,ad=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Oa(t,this.data,this.fieldMask,e,this.fieldTransforms):new ka(t,this.data,e,this.fieldTransforms)},t}(),ud=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Oa(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ro()}}var hd=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},t.prototype.Lc=function(t){return Rd(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(cd(this.Nc)&&sd.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),ld=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Tl(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new hd({Nc:t,methodName:e,qc:n,path:Ho.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function fd(t){var e=t._freezeSettings(),n=Tl(t._databaseId);return new ld(t._databaseId,!!e.ignoreUndefinedProperties,n)}function pd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Ad("Data must be an object, but it was:",s,r);var a,u,c=Td(r,s);if(o.merge)a=new Qo(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=Nd(e,f[l],n);if(!s.contains(p))throw new _o(Io.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");kd(h,p)||h.push(p)}a=new Qo(h),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new ad(new ws(c),a,u)}var dd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(id);function yd(t,e,n){return new hd({Nc:3,qc:e.settings.qc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var vd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._toFieldTransform=function(t){return new Ea(t.path,new pa)},e.prototype.isEqual=function(t){return t instanceof e},e}(id),gd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return i(e,t),e.prototype._toFieldTransform=function(t){var e=yd(this,t,!0),n=this.Kc.map((function(t){return _d(t,e)})),r=new da(n);return new Ea(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(id),md=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return i(e,t),e.prototype._toFieldTransform=function(t){var e=yd(this,t,!0),n=this.Kc.map((function(t){return _d(t,e)})),r=new va(n);return new Ea(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(id),bd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return i(e,t),e.prototype._toFieldTransform=function(t){var e=new ma(t.R,ua(t.R,this.Qc));return new Ea(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(id);function wd(t,e,n,r){var i=t.Uc(1,e,n);Ad("Data must be an object, but it was:",i,r);var o=[],s=ws.empty();jo(r,(function(t,r){var a=Cd(e,t,n);r=j(r);var u=i.Oc(a);if(r instanceof dd)o.push(a);else{var c=_d(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new Qo(o);return new ud(s,a,i.fieldTransforms)}function Ed(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[Nd(e,r,n)],u=[i];if(o.length%2!=0)throw new _o(Io.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Nd(e,o[c])),u.push(o[c+1]);for(var h=[],l=ws.empty(),f=a.length-1;f>=0;--f)if(!kd(h,a[f])){var p=a[f],d=u[f];d=j(d);var y=s.Oc(p);if(d instanceof dd)h.push(p);else{var v=_d(d,y);null!=v&&(h.push(p),l.set(p,v))}}var g=new Qo(h);return new ud(l,g,s.fieldTransforms)}function Id(t,e,n,r){return void 0===r&&(r=!1),_d(n,t.Uc(r?4:3,e))}function _d(t,e){if(Sd(t=j(t)))return Ad("Unsupported field value:",e,t),Td(t,e);if(t instanceof id)return function(t,e){if(!cd(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=_d(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=j(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ua(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Vo.fromDate(t);return{timestampValue:vu(e.R,n)}}if(t instanceof Vo)return n=new Vo(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:vu(e.R,n)};if(t instanceof od)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof rd)return{bytesValue:gu(e.R,t._byteString)};if(t instanceof jp){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:wu(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+Mp(t))}(t,e)}function Td(t,e){var n={};return Bo(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jo(t,(function(t,r){var i=_d(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Sd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Vo||t instanceof od||t instanceof rd||t instanceof jp||t instanceof id)}function Ad(t,e,n){if(!Sd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Mp(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function Nd(t,e,n){if((e=j(e))instanceof nd)return e._internalPath;if("string"==typeof e)return Cd(t,e);throw Rd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Dd=new RegExp("[~\\*/\\[\\]]");function Cd(t,e,n){if(e.search(Dd)>=0)throw Rd("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(nd.bind.apply(nd,h([void 0],e.split(".")))))._internalPath}catch(r){throw Rd("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Rd(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new _o(Io.INVALID_ARGUMENT,(a+=". ")+t+u)}function kd(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Od=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new jp(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new xd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Ld("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),xd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Od);function Ld(t,e){return"string"==typeof e?Cd(t,e):e instanceof nd?e._internalPath:e._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pd=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Md=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return i(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Fd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Ld("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Od),Fd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Md),Vd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Pd(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Fd(n._firestore,n._userDataWriter,r.key,r,new Pd(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new _o(Io.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new Fd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Pd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Fd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Pd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Ud(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Ud(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ro()}}function qd(t,e){return t instanceof Md&&e instanceof Md?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Vd&&e instanceof Vd&&t._firestore===e._firestore&&Qp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(t){if(Qs(t)&&0===t.explicitOrderBy.length)throw new _o(Io.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Bd=function(){};function Kd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var zd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return i(e,t),e.prototype._apply=function(t){var e=fd(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new _o(Io.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){$d(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(Xd(r,t,l))}a={arrayValue:{values:u}}}else a=Xd(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||$d(s,o),a=Id(n,"where",s,"in"===o||"not-in"===o);var f=Ds.create(i,o,a);return function(t,e){if(e.g()){var n=Ys(t);if(null!==n&&!n.isEqual(e.field))throw new _o(Io.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Ws(t);null!==r&&Jd(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new _o(Io.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new _o(Io.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new Bp(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Ks(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Bd),Gd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return i(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new _o(Io.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new _o(Io.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Us(e,n);return function(t,e){if(null===Ws(t)){var n=Ys(t);null!==n&&Jd(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new Bp(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Ks(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Bd),Hd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return i(e,t),e.prototype._apply=function(t){return new Bp(t.firestore,t.converter,Zs(t._query,this.Hc,this.Jc))},e}(Bd),Qd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return i(e,t),e.prototype._apply=function(t){var e=Yd(t,this.type,this.Yc,this.Xc);return new Bp(t.firestore,t.converter,function(t,e){return new Ks(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Bd),Wd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return i(e,t),e.prototype._apply=function(t){var e=Yd(t,this.type,this.Yc,this.Xc);return new Bp(t.firestore,t.converter,function(t,e){return new Ks(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Bd);function Yd(t,e,n,r){if(n[0]=j(n[0]),n[0]instanceof Od)return function(t,e,n,r,i){if(!r)throw new _o(Io.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=$s(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(ps(e,r.key));else{var c=r.data.field(u.field);if(Zo(c))throw new _o(Io.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new _o(Io.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Fs(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=fd(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new _o(Io.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new _o(Io.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Xs(t)&&-1!==c.indexOf("/"))throw new _o(Io.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(zo.fromString(c));if(!os.isDocumentKey(h))throw new _o(Io.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new os(h);a.push(ps(e,l))}else{var f=Id(n,r,c);a.push(f)}}return new Fs(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function Xd(t,e,n){if("string"==typeof(n=j(n))){if(""===n)throw new _o(Io.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xs(e)&&-1!==n.indexOf("/"))throw new _o(Io.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(zo.fromString(n));if(!os.isDocumentKey(r))throw new _o(Io.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ps(t,new os(r))}if(n instanceof jp)return ps(t,n._key);throw new _o(Io.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Mp(n)+".")}function $d(t,e){if(!Array.isArray(t)||0===t.length)throw new _o(Io.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new _o(Io.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Jd(t,e,n){if(!n.isEqual(e))throw new _o(Io.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zd=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),ss(t)){case 0:return null;case 1:return t.booleanValue;case 2:return $o(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Jo(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Ro()}},t.prototype.convertObject=function(t,e){var n=this,r={};return jo(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new od($o(t.latitude),$o(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=ts(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(es(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Xo(t);return new Vo(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=zo.fromString(t);ko(Gu(n));var r=new _p(n.get(1),n.get(3)),i=new os(n.popFirst(5));return r.isEqual(e)||No("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ey=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return i(e,t),e.prototype.convertBytes=function(t){return new rd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new jp(this.firestore,null,e)},e}(Zd),ny=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=fd(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=ry(t,this._firestore),i=ty(r.converter,e,n),o=pd(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,_a.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=ry(t,this._firestore);return o="string"==typeof(e=j(e))||e instanceof nd?Ed(this._dataReader,"WriteBatch.update",s._key,e,n,r):wd(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,_a.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=ry(t,this._firestore);return this._mutations=this._mutations.concat(new Va(e._key,_a.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new _o(Io.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ry(t,e){if((t=j(t)).firestore!==e)throw new _o(Io.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var iy=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return i(e,t),e.prototype.convertBytes=function(t){return new rd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new jp(this.firestore,null,e)},e}(Zd);function oy(t,e,n){t=Fp(t,jp);var r=Fp(t.firestore,$p),i=ty(t.converter,e,n);return uy(r,[pd(fd(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,_a.none())])}function sy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Fp(t,jp);var o=Fp(t.firestore,$p),s=fd(o);return uy(o,[("string"==typeof(e=j(e))||e instanceof nd?Ed(s,"updateDoc",t._key,e,n,r):wd(s,"updateDoc",t._key,e)).toMutation(t._key,_a.exists(!0))])}function ay(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=j(t);var u={includeMetadataChanges:!1},c=0;"object"!=typeof i[c]||Yp(i[c])||(u=i[c],c++);var h,l,f,p={includeMetadataChanges:u.includeMetadataChanges};if(Yp(i[c])){var d=i[c];i[c]=null===(e=d.next)||void 0===e?void 0:e.bind(d),i[c+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),i[c+2]=null===(r=d.complete)||void 0===r?void 0:r.bind(d)}if(t instanceof jp)l=Fp(t.firestore,$p),f=Gs(t._key.path),h={next:function(e){i[c]&&i[c](cy(l,t,e))},error:i[c+1],complete:i[c+2]};else{var y=Fp(t,Bp);l=Fp(y.firestore,$p),f=y._query;var v=new iy(l);h={next:function(t){i[c]&&i[c](new Vd(l,v,y,t))},error:i[c+1],complete:i[c+2]},jd(t._query)}return function(t,e,n,r){var i=this,o=new ap(r),u=new vf(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return s(i,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return e=lf,[4,bp(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return s(i,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return e=ff,[4,bp(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))}))}}(Jp(l),f,p,h)}function uy(t,e){return function(t,e){var n=this,r=new yc;return t.asyncQueue.enqueueAndForget((function(){return s(n,void 0,void 0,(function(){var n;return a(this,(function(i){switch(i.label){case 0:return n=Cf,[4,mp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Jp(t),e)}function cy(t,e,n){var r=n.docs.get(e._key),i=new iy(t);return new Md(t,i,e._key,r,new Pd(n.hasPendingWrites,n.fromCache),e.converter)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hy=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return i(e,t),e.prototype.get=function(e){var n=this,r=ry(e,this._firestore),i=new iy(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Md(n._firestore,i,r._key,t._document,new Pd(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=fd(t)}return t.prototype.get=function(t){var e=this,n=ry(t,this._firestore),r=new ey(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Ro();var i=t[0];if(i.isFoundDocument())return new Od(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Od(e._firestore,r,n._key,null,n.converter);throw Ro()}))},t.prototype.set=function(t,e,n){var r=ry(t,this._firestore),i=ty(r.converter,e,n),o=pd(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=ry(t,this._firestore);return o="string"==typeof(e=j(e))||e instanceof nd?Ed(this._dataReader,"Transaction.update",s._key,e,n,r):wd(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=ry(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ly(){if("undefined"==typeof Uint8Array)throw new _o(Io.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function fy(){if("undefined"==typeof atob)throw new _o(Io.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var py=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return fy(),new t(rd.fromBase64String(e))},t.fromUint8Array=function(e){return ly(),new t(rd.fromUint8Array(e))},t.prototype.toBase64=function(){return fy(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return ly(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),dy=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){ed(t=Fp(t,$p));var n=Jp(t),r=t._freezeSettings(),i=new sp;return td(n,i,new ip(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){ed(t=Fp(t,$p));var e=Jp(t),n=t._freezeSettings(),r=new sp;return td(e,r,new op(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new _o(Io.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new yc;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return s(e,void 0,void 0,(function(){var e;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return mc.yt()?(e=t+"main",[4,mc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Ch(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),yy=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof _p||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Do("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){var i;void 0===r&&(r={});var o=(t=Fp(t,qp))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Do("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),r.mockUserToken){var s,a;if("string"==typeof r.mockUserToken)s=r.mockUserToken,a=sl.MOCK_USER;else{s=w(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);var u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new _o(Io.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new sl(u)}t._credentials=new Np(new Sp(s,a))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return s(e,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return[4,yp(t)];case 1:return e=r.sent(),[4,gp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Oo(t);return e.Or.delete(0),Ol(e)}(n))]}}))}))}))}(Jp(Fp(this._delegate,$p)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return s(e,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return[4,yp(t)];case 1:return e=r.sent(),[4,gp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return(e=Oo(t)).Or.add(0),[4,xl(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Jp(Fp(this._delegate,$p)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&xp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new yc;return t.asyncQueue.enqueueAndForget((function(){return s(e,void 0,void 0,(function(){var e;return a(this,(function(r){switch(r.label){case 0:return e=Pf,[4,mp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Jp(Fp(this._delegate,$p)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new ap(e);return t.asyncQueue.enqueueAndForget((function(){return s(n,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return e=function(t,e){Oo(t).Gr.add(e),e.next()},[4,bp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return s(n,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return e=function(t,e){Oo(t).Gr.delete(e)},[4,bp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Jp(t=Fp(t,$p)),Yp(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new _o(Io.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Ry(this,zp(this._delegate,t))}catch(t){throw Iy(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Ey(this,Gp(this._delegate,t))}catch(t){throw Iy(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Ny(this,function(t,e){if(t=Fp(t,qp),kp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new _o(Io.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Bp(t,null,function(t){return new Ks(zo.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Iy(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new yc;return t.asyncQueue.enqueueAndForget((function(){return s(n,void 0,void 0,(function(){var n;return a(this,(function(i){switch(i.label){case 0:return[4,function(t){return dp(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new cp(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(Jp(t),(function(n){return e(new hy(t,n))}))}(this._delegate,(function(n){return t(new my(e,n))}))},t.prototype.batch=function(){var t=this;return Jp(this._delegate),new by(new ny(this._delegate,(function(e){return uy(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new _o(Io.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new _o(Io.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),vy=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return i(e,t),e.prototype.convertBytes=function(t){return new py(new rd(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Ey.eu(e,this.firestore,null)},e}(Zd);function gy(t){var e;e=t,To.setLogLevel(e)}var my=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new vy(t)}return t.prototype.get=function(t){var e=this,n=ky(t);return this._delegate.get(n).then((function(t){return new Sy(e._firestore,new Md(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=ky(t);return n?(Op("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ky(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,h([s,e,n],i)),this},t.prototype.delete=function(t){var e=ky(t);return this._delegate.delete(e),this},t}(),by=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=ky(t);return n?(Op("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ky(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,h([s,e,n],i)),this},t.prototype.delete=function(t){var e=ky(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),wy=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Fd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Ay(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new vy(e),n),i.set(n,o)),o},t}();wy.su=new WeakMap;var Ey=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new vy(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new _o(Io.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new jp(n._delegate,r,new os(e)))},t.eu=function(e,n,r){return new t(n,new jp(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ry(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Ry(this.firestore,zp(this._delegate,t))}catch(t){throw Iy(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=j(t))instanceof jp&&Hp(this._delegate,t)},t.prototype.set=function(t,e){e=Op("DocumentReference.set",e);try{return e?oy(this._delegate,t,e):oy(this._delegate,t)}catch(t){throw Iy(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?sy(this._delegate,t):sy.apply(void 0,h([this._delegate,t,e],n))}catch(t){throw Iy(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return uy(Fp((t=this._delegate).firestore,$p),[new Va(t._key,_a.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=_y(e),i=Ty(e,(function(e){return new Sy(t.firestore,new Md(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return ay(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Fp(t,jp);var e=Fp(t.firestore,$p),n=Jp(e),r=new iy(e);return function(t,e){var n=this,r=new yc;return t.asyncQueue.enqueueAndForget((function(){return s(n,void 0,void 0,(function(){var n;return a(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return s(this,void 0,void 0,(function(){var r,i;return a(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Oo(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new _o(Io.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=of(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,vp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Md(e,r,t._key,n,new Pd(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Fp(t,jp);var e=Fp(t.firestore,$p);return wp(Jp(e),t._key,{source:"server"}).then((function(n){return cy(e,t,n)}))}(this._delegate):function(t){t=Fp(t,jp);var e=Fp(t.firestore,$p);return wp(Jp(e),t._key).then((function(n){return cy(e,t,n)}))}(this._delegate)).then((function(t){return new Sy(e.firestore,new Md(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(wy.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Iy(t,e,n){return t.message=t.message.replace(e,n),t}function _y(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Yp(r))return r}return{}}function Ty(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Yp(t[0])?t[0]:Yp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Sy=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Ey(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return qd(this._delegate,t._delegate)},t}(),Ay=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Sy),Ny=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new vy(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Kd(this._delegate,function(t,e,n){var r=e,i=Ld("where",t);return new zd(i,r,n)}(e,n,r)))}catch(e){throw Iy(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Kd(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Ld("orderBy",t);return new Gd(r,n)}(e,n)))}catch(e){throw Iy(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Kd(this._delegate,function(t){return Vp("limit",t),new Hd("limit",t,"F")}(e)))}catch(e){throw Iy(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Kd(this._delegate,function(t){return Vp("limitToLast",t),new Hd("limitToLast",t,"L")}(e)))}catch(e){throw Iy(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Kd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qd("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Iy(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Kd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qd("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Iy(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Kd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Wd("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Iy(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Kd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Wd("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Iy(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return Qp(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Fp(t,Bp);var e=Fp(t.firestore,$p),n=Jp(e),r=new iy(e);return function(t,e){var n=this,r=new yc;return t.asyncQueue.enqueueAndForget((function(){return s(n,void 0,void 0,(function(){var n;return a(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return s(this,void 0,void 0,(function(){var r,i,o,s,u;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,zh(t,e,!0)];case 1:return u=a.sent(),r=new If(e,u.Bn),i=r._o(u.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=of(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))},[4,vp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Vd(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Fp(t,Bp);var e=Fp(t.firestore,$p),n=Jp(e),r=new iy(e);return Ep(n,t._query,{source:"server"}).then((function(n){return new Vd(e,r,t,n)}))}(this._delegate):function(t){t=Fp(t,Bp);var e=Fp(t.firestore,$p),n=Jp(e),r=new iy(e);return jd(t._query),Ep(n,t._query).then((function(n){return new Vd(e,r,t,n)}))}(this._delegate)).then((function(t){return new Cy(e.firestore,new Vd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=_y(e),i=Ty(e,(function(e){return new Cy(t.firestore,new Vd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return ay(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(wy.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Dy=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Ay(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Cy=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Ny(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Ay(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Dy(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Ay(n._firestore,r))}))},t.prototype.isEqual=function(t){return qd(this._delegate,t._delegate)},t}(),Ry=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Ey(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Ey(this.firestore,void 0===t?Gp(this._delegate):Gp(this._delegate,t))}catch(t){throw Iy(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Fp(t.firestore,$p),r=Gp(t),i=ty(t.converter,e);return uy(n,[pd(fd(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,_a.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new Ey(e.firestore,t)}))},e.prototype.isEqual=function(t){return Hp(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(wy.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(Ny);function ky(t){return Fp(t,jp)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oy=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(nd.bind.apply(nd,h([void 0],t)))}return t.documentId=function(){return new t(Ho.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=j(t))instanceof nd&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),xy=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new vd("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new dd("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gd("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new md("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new bd("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ly={Firestore:yy,GeoPoint:od,Timestamp:Vo,Blob:py,Transaction:my,WriteBatch:by,DocumentReference:Ey,DocumentSnapshot:Sy,Query:Ny,QueryDocumentSnapshot:Ay,QuerySnapshot:Cy,CollectionReference:Ry,FieldPath:Oy,FieldValue:xy,setLogLevel:gy,CACHE_SIZE_UNLIMITED:Xp};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Py(t){!function(t,e){t.INTERNAL.registerComponent(new B("firestore",(function(t){var n=t.getProvider("app").getImmediate();return e(n,t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Ly)))}(t,(function(t,e){return new yy(t,new $p(t,e),new dy)})),t.registerVersion("@firebase/firestore","2.4.1")}Py(Ft);const My={apiKey:"AIzaSyAi0FdcxdseEEherBZ9_sffZ4qCdTMpmMU",authDomain:"thuybanhang-92229.firebaseapp.com",projectId:"thuybanhang-92229",storageBucket:"thuybanhang-92229.appspot.com",messagingSenderId:"58654744526",appId:"1:58654744526:web:957193785f9b77a3bcd59f",measurementId:"G-815MV566D6"},Fy=Ft.initializeApp(My),Vy=Fy.firestore()}}]);
//# sourceMappingURL=805.2a867d81.js.map